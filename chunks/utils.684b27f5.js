var Qn=Object.defineProperty,Jn=Object.defineProperties;var Zn=Object.getOwnPropertyDescriptors;var Ft=Object.getOwnPropertySymbols;var es=Object.prototype.hasOwnProperty,ts=Object.prototype.propertyIsEnumerable;var Nt=(s,e,t)=>e in s?Qn(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,It=(s,e)=>{for(var t in e||(e={}))es.call(e,t)&&Nt(s,t,e[t]);if(Ft)for(var t of Ft(e))ts.call(e,t)&&Nt(s,t,e[t]);return s},Bt=(s,e)=>Jn(s,Zn(e));import{E as ns,V as D,b as he,T as pe,Q as qe,c as Ut,d as X,D as ss,H as De,F as Fe,e as Ne,L as Ht,f as me,g as is,h as Gt,i as te,j as Ie,C as G,k as os,l as rs,m as as,n as Ee,s as ce,o as _e,p as Qe,q as cs,I as ls,N as us,r as ds,t as fs,u as hs,v as Vt,w as jt,x as zt,R as Be,y as Kt,z as ps,B as ms,G as _s,J as gs,K as bs,O as Ue,U as ys,W as He,X as Es,Y as vs,Z as Ts,_ as Xt,$ as ws,M as xs,a0 as As,a1 as Yt,a2 as Ss,a3 as Rs,a4 as Ls,a5 as Ms,a6 as Je,P as Cs,a7 as Os,a8 as ks,a9 as Ps,aa as Wt,ab as Ds,ac as Fs,ad as Ns,ae as Is,af as $t,ag as Bs,ah as Us,ai as qt,aj as q,ak as Hs,al as Gs,A as Vs,am as js,an as zs,ao as ve,ap as Ks}from"./vendor.b603f603.js";const Xs=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&n(r)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerpolicy&&(o.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?o.credentials="include":i.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}};Xs();const Qt={type:"change"},Ze={type:"start"},et={type:"end"};class Oo extends ns{constructor(e,t){super();t===void 0&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),t===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new D,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:he.ROTATE,MIDDLE:he.DOLLY,RIGHT:he.PAN},this.touches={ONE:pe.ROTATE,TWO:pe.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return a.phi},this.getAzimuthalAngle=function(){return a.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(h){h.addEventListener("keydown",Ct),this._domElementKeyEvents=h},this.saveState=function(){n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=function(){n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(Qt),n.update(),o=i.NONE},this.update=function(){const h=new D,R=new qe().setFromUnitVectors(e.up,new D(0,1,0)),B=R.clone().invert(),H=new D,Y=new qe,fe=2*Math.PI;return function(){const Dt=n.object.position;h.copy(Dt).sub(n.target),h.applyQuaternion(R),a.setFromVector3(h),n.autoRotate&&o===i.NONE&&A(L()),n.enableDamping?(a.theta+=c.theta*n.dampingFactor,a.phi+=c.phi*n.dampingFactor):(a.theta+=c.theta,a.phi+=c.phi);let Z=n.minAzimuthAngle,ee=n.maxAzimuthAngle;return isFinite(Z)&&isFinite(ee)&&(Z<-Math.PI?Z+=fe:Z>Math.PI&&(Z-=fe),ee<-Math.PI?ee+=fe:ee>Math.PI&&(ee-=fe),Z<=ee?a.theta=Math.max(Z,Math.min(ee,a.theta)):a.theta=a.theta>(Z+ee)/2?Math.max(Z,a.theta):Math.min(ee,a.theta)),a.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,a.phi)),a.makeSafe(),a.radius*=u,a.radius=Math.max(n.minDistance,Math.min(n.maxDistance,a.radius)),n.enableDamping===!0?n.target.addScaledVector(l,n.dampingFactor):n.target.add(l),h.setFromSpherical(a),h.applyQuaternion(B),Dt.copy(n.target).add(h),n.object.lookAt(n.target),n.enableDamping===!0?(c.theta*=1-n.dampingFactor,c.phi*=1-n.dampingFactor,l.multiplyScalar(1-n.dampingFactor)):(c.set(0,0,0),l.set(0,0,0)),u=1,d||H.distanceToSquared(n.object.position)>r||8*(1-Y.dot(n.object.quaternion))>r?(n.dispatchEvent(Qt),H.copy(n.object.position),Y.copy(n.object.quaternion),d=!1,!0):!1}}(),this.dispose=function(){n.domElement.removeEventListener("contextmenu",Ot),n.domElement.removeEventListener("pointerdown",Rt),n.domElement.removeEventListener("pointercancel",Lt),n.domElement.removeEventListener("wheel",Mt),n.domElement.removeEventListener("pointermove",Ye),n.domElement.removeEventListener("pointerup",We),n._domElementKeyEvents!==null&&n._domElementKeyEvents.removeEventListener("keydown",Ct)};const n=this,i={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let o=i.NONE;const r=1e-6,a=new Ut,c=new Ut;let u=1;const l=new D;let d=!1;const f=new X,m=new X,y=new X,_=new X,g=new X,v=new X,w=new X,T=new X,x=new X,b=[],S={};function L(){return 2*Math.PI/60/60*n.autoRotateSpeed}function C(){return Math.pow(.95,n.zoomSpeed)}function A(h){c.theta-=h}function k(h){c.phi-=h}const M=function(){const h=new D;return function(B,H){h.setFromMatrixColumn(H,0),h.multiplyScalar(-B),l.add(h)}}(),P=function(){const h=new D;return function(B,H){n.screenSpacePanning===!0?h.setFromMatrixColumn(H,1):(h.setFromMatrixColumn(H,0),h.crossVectors(n.object.up,h)),h.multiplyScalar(B),l.add(h)}}(),I=function(){const h=new D;return function(B,H){const Y=n.domElement;if(n.object.isPerspectiveCamera){const fe=n.object.position;h.copy(fe).sub(n.target);let Pe=h.length();Pe*=Math.tan(n.object.fov/2*Math.PI/180),M(2*B*Pe/Y.clientHeight,n.object.matrix),P(2*H*Pe/Y.clientHeight,n.object.matrix)}else n.object.isOrthographicCamera?(M(B*(n.object.right-n.object.left)/n.object.zoom/Y.clientWidth,n.object.matrix),P(H*(n.object.top-n.object.bottom)/n.object.zoom/Y.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}}();function V(h){n.object.isPerspectiveCamera?u/=h:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom*h)),n.object.updateProjectionMatrix(),d=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function N(h){n.object.isPerspectiveCamera?u*=h:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/h)),n.object.updateProjectionMatrix(),d=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function ae(h){f.set(h.clientX,h.clientY)}function K(h){w.set(h.clientX,h.clientY)}function j(h){_.set(h.clientX,h.clientY)}function ke(h){m.set(h.clientX,h.clientY),y.subVectors(m,f).multiplyScalar(n.rotateSpeed);const R=n.domElement;A(2*Math.PI*y.x/R.clientHeight),k(2*Math.PI*y.y/R.clientHeight),f.copy(m),n.update()}function Nn(h){T.set(h.clientX,h.clientY),x.subVectors(T,w),x.y>0?V(C()):x.y<0&&N(C()),w.copy(T),n.update()}function In(h){g.set(h.clientX,h.clientY),v.subVectors(g,_).multiplyScalar(n.panSpeed),I(v.x,v.y),_.copy(g),n.update()}function Bn(h){h.deltaY<0?N(C()):h.deltaY>0&&V(C()),n.update()}function Un(h){let R=!1;switch(h.code){case n.keys.UP:I(0,n.keyPanSpeed),R=!0;break;case n.keys.BOTTOM:I(0,-n.keyPanSpeed),R=!0;break;case n.keys.LEFT:I(n.keyPanSpeed,0),R=!0;break;case n.keys.RIGHT:I(-n.keyPanSpeed,0),R=!0;break}R&&(h.preventDefault(),n.update())}function vt(){if(b.length===1)f.set(b[0].pageX,b[0].pageY);else{const h=.5*(b[0].pageX+b[1].pageX),R=.5*(b[0].pageY+b[1].pageY);f.set(h,R)}}function Tt(){if(b.length===1)_.set(b[0].pageX,b[0].pageY);else{const h=.5*(b[0].pageX+b[1].pageX),R=.5*(b[0].pageY+b[1].pageY);_.set(h,R)}}function wt(){const h=b[0].pageX-b[1].pageX,R=b[0].pageY-b[1].pageY,B=Math.sqrt(h*h+R*R);w.set(0,B)}function Hn(){n.enableZoom&&wt(),n.enablePan&&Tt()}function Gn(){n.enableZoom&&wt(),n.enableRotate&&vt()}function xt(h){if(b.length==1)m.set(h.pageX,h.pageY);else{const B=$e(h),H=.5*(h.pageX+B.x),Y=.5*(h.pageY+B.y);m.set(H,Y)}y.subVectors(m,f).multiplyScalar(n.rotateSpeed);const R=n.domElement;A(2*Math.PI*y.x/R.clientHeight),k(2*Math.PI*y.y/R.clientHeight),f.copy(m)}function At(h){if(b.length===1)g.set(h.pageX,h.pageY);else{const R=$e(h),B=.5*(h.pageX+R.x),H=.5*(h.pageY+R.y);g.set(B,H)}v.subVectors(g,_).multiplyScalar(n.panSpeed),I(v.x,v.y),_.copy(g)}function St(h){const R=$e(h),B=h.pageX-R.x,H=h.pageY-R.y,Y=Math.sqrt(B*B+H*H);T.set(0,Y),x.set(0,Math.pow(T.y/w.y,n.zoomSpeed)),V(x.y),w.copy(T)}function Vn(h){n.enableZoom&&St(h),n.enablePan&&At(h)}function jn(h){n.enableZoom&&St(h),n.enableRotate&&xt(h)}function Rt(h){n.enabled!==!1&&(b.length===0&&(n.domElement.setPointerCapture(h.pointerId),n.domElement.addEventListener("pointermove",Ye),n.domElement.addEventListener("pointerup",We)),qn(h),h.pointerType==="touch"?Yn(h):zn(h))}function Ye(h){n.enabled!==!1&&(h.pointerType==="touch"?Wn(h):Kn(h))}function We(h){n.enabled!==!1&&(h.pointerType==="touch"?$n():Xn(),kt(h),b.length===0&&(n.domElement.releasePointerCapture(h.pointerId),n.domElement.removeEventListener("pointermove",Ye),n.domElement.removeEventListener("pointerup",We)))}function Lt(h){kt(h)}function zn(h){let R;switch(h.button){case 0:R=n.mouseButtons.LEFT;break;case 1:R=n.mouseButtons.MIDDLE;break;case 2:R=n.mouseButtons.RIGHT;break;default:R=-1}switch(R){case he.DOLLY:if(n.enableZoom===!1)return;K(h),o=i.DOLLY;break;case he.ROTATE:if(h.ctrlKey||h.metaKey||h.shiftKey){if(n.enablePan===!1)return;j(h),o=i.PAN}else{if(n.enableRotate===!1)return;ae(h),o=i.ROTATE}break;case he.PAN:if(h.ctrlKey||h.metaKey||h.shiftKey){if(n.enableRotate===!1)return;ae(h),o=i.ROTATE}else{if(n.enablePan===!1)return;j(h),o=i.PAN}break;default:o=i.NONE}o!==i.NONE&&n.dispatchEvent(Ze)}function Kn(h){if(n.enabled!==!1)switch(o){case i.ROTATE:if(n.enableRotate===!1)return;ke(h);break;case i.DOLLY:if(n.enableZoom===!1)return;Nn(h);break;case i.PAN:if(n.enablePan===!1)return;In(h);break}}function Xn(h){n.dispatchEvent(et),o=i.NONE}function Mt(h){n.enabled===!1||n.enableZoom===!1||o!==i.NONE&&o!==i.ROTATE||(h.preventDefault(),n.dispatchEvent(Ze),Bn(h),n.dispatchEvent(et))}function Ct(h){n.enabled===!1||n.enablePan===!1||Un(h)}function Yn(h){switch(Pt(h),b.length){case 1:switch(n.touches.ONE){case pe.ROTATE:if(n.enableRotate===!1)return;vt(),o=i.TOUCH_ROTATE;break;case pe.PAN:if(n.enablePan===!1)return;Tt(),o=i.TOUCH_PAN;break;default:o=i.NONE}break;case 2:switch(n.touches.TWO){case pe.DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;Hn(),o=i.TOUCH_DOLLY_PAN;break;case pe.DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;Gn(),o=i.TOUCH_DOLLY_ROTATE;break;default:o=i.NONE}break;default:o=i.NONE}o!==i.NONE&&n.dispatchEvent(Ze)}function Wn(h){switch(Pt(h),o){case i.TOUCH_ROTATE:if(n.enableRotate===!1)return;xt(h),n.update();break;case i.TOUCH_PAN:if(n.enablePan===!1)return;At(h),n.update();break;case i.TOUCH_DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;Vn(h),n.update();break;case i.TOUCH_DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;jn(h),n.update();break;default:o=i.NONE}}function $n(h){n.dispatchEvent(et),o=i.NONE}function Ot(h){n.enabled!==!1&&h.preventDefault()}function qn(h){b.push(h)}function kt(h){delete S[h.pointerId];for(let R=0;R<b.length;R++)if(b[R].pointerId==h.pointerId){b.splice(R,1);return}}function Pt(h){let R=S[h.pointerId];R===void 0&&(R=new X,S[h.pointerId]=R),R.set(h.pageX,h.pageY)}function $e(h){const R=h.pointerId===b[0].pointerId?b[1]:b[0];return S[R.pointerId]}n.domElement.addEventListener("contextmenu",Ot),n.domElement.addEventListener("pointerdown",Rt),n.domElement.addEventListener("pointercancel",Lt),n.domElement.addEventListener("wheel",Mt,{passive:!1}),this.update()}}class Ys extends ss{constructor(e){super(e);this.type=De}parse(e){const t=-1,n=1,i=2,o=3,r=4,a=function(T,x){switch(T){case n:console.error("THREE.RGBELoader Read Error: "+(x||""));break;case i:console.error("THREE.RGBELoader Write Error: "+(x||""));break;case o:console.error("THREE.RGBELoader Bad File Format: "+(x||""));break;default:case r:console.error("THREE.RGBELoader: Error: "+(x||""))}return t},c=1,u=2,l=4,d=`
`,f=function(T,x,b){const S=128;x=x||1024;let L=T.pos,C=-1,A=0,k="",M=String.fromCharCode.apply(null,new Uint16Array(T.subarray(L,L+S)));for(;0>(C=M.indexOf(d))&&A<x&&L<T.byteLength;)k+=M,A+=M.length,L+=S,M+=String.fromCharCode.apply(null,new Uint16Array(T.subarray(L,L+S)));return-1<C?(b!==!1&&(T.pos+=A+C+1),k+M.slice(0,C)):!1},m=function(T){const x=/^#\?(\S+)/,b=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,S=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,L=/^\s*FORMAT=(\S+)\s*$/,C=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,A={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let k,M;if(T.pos>=T.byteLength||!(k=f(T)))return a(n,"no header found");if(!(M=k.match(x)))return a(o,"bad initial token");for(A.valid|=c,A.programtype=M[1],A.string+=k+`
`;k=f(T),k!==!1;){if(A.string+=k+`
`,k.charAt(0)==="#"){A.comments+=k+`
`;continue}if((M=k.match(b))&&(A.gamma=parseFloat(M[1])),(M=k.match(S))&&(A.exposure=parseFloat(M[1])),(M=k.match(L))&&(A.valid|=u,A.format=M[1]),(M=k.match(C))&&(A.valid|=l,A.height=parseInt(M[1],10),A.width=parseInt(M[2],10)),A.valid&u&&A.valid&l)break}return A.valid&u?A.valid&l?A:a(o,"missing image size specifier"):a(o,"missing format specifier")},y=function(T,x,b){const S=x;if(S<8||S>32767||T[0]!==2||T[1]!==2||T[2]&128)return new Uint8Array(T);if(S!==(T[2]<<8|T[3]))return a(o,"wrong scanline width");const L=new Uint8Array(4*x*b);if(!L.length)return a(r,"unable to allocate buffer space");let C=0,A=0;const k=4*S,M=new Uint8Array(4),P=new Uint8Array(k);let I=b;for(;I>0&&A<T.byteLength;){if(A+4>T.byteLength)return a(n);if(M[0]=T[A++],M[1]=T[A++],M[2]=T[A++],M[3]=T[A++],M[0]!=2||M[1]!=2||(M[2]<<8|M[3])!=S)return a(o,"bad rgbe scanline format");let V=0,N;for(;V<k&&A<T.byteLength;){N=T[A++];const K=N>128;if(K&&(N-=128),N===0||V+N>k)return a(o,"bad scanline data");if(K){const j=T[A++];for(let ke=0;ke<N;ke++)P[V++]=j}else P.set(T.subarray(A,A+N),V),V+=N,A+=N}const ae=S;for(let K=0;K<ae;K++){let j=0;L[C]=P[K+j],j+=S,L[C+1]=P[K+j],j+=S,L[C+2]=P[K+j],j+=S,L[C+3]=P[K+j],C+=4}I--}return L},_=function(T,x,b,S){const L=T[x+3],C=Math.pow(2,L-128)/255;b[S+0]=T[x+0]*C,b[S+1]=T[x+1]*C,b[S+2]=T[x+2]*C,b[S+3]=1},g=function(T,x,b,S){const L=T[x+3],C=Math.pow(2,L-128)/255;b[S+0]=Ne.toHalfFloat(Math.min(T[x+0]*C,65504)),b[S+1]=Ne.toHalfFloat(Math.min(T[x+1]*C,65504)),b[S+2]=Ne.toHalfFloat(Math.min(T[x+2]*C,65504)),b[S+3]=Ne.toHalfFloat(1)},v=new Uint8Array(e);v.pos=0;const w=m(v);if(t!==w){const T=w.width,x=w.height,b=y(v.subarray(v.pos),T,x);if(t!==b){let S,L,C,A;switch(this.type){case Fe:A=b.length/4;const k=new Float32Array(A*4);for(let P=0;P<A;P++)_(b,P*4,k,P*4);S=k,C=Fe;break;case De:A=b.length/4;const M=new Uint16Array(A*4);for(let P=0;P<A;P++)g(b,P*4,M,P*4);S=M,C=De;break;default:console.error("THREE.RGBELoader: unsupported type: ",this.type);break}return{width:T,height:x,data:S,header:w.string,gamma:w.gamma,exposure:w.exposure,format:L,type:C}}}return null}setDataType(e){return this.type=e,this}load(e,t,n,i){function o(r,a){switch(r.type){case Fe:r.encoding=Ht,r.minFilter=me,r.magFilter=me,r.generateMipmaps=!1,r.flipY=!0;break;case De:r.encoding=Ht,r.minFilter=me,r.magFilter=me,r.generateMipmaps=!1,r.flipY=!0;break}t&&t(r,a)}return super.load(e,o,n,i)}}const ko={Sunset:"/envMaps/sunset_1k.hdr",Konzerthaus:"/envMaps/konzerthaus_1k.hdr",Dirlight:"/envMaps/gray-background-with-dirlight_1k.hdr",VeniceSunset:"/envMaps/venice_sunset_2k.hdr",LightBooth:"/envMaps/LightBooth.hdr",Powerplant:"/envMaps/peppermint_powerplant_4k.hdr",LightRoom:"/envMaps/lightroom_14b.hdr",PaperMill:"/envMaps/PaperMill_E_3k.hdr",Arches:"/envMaps/Arches_E_PineTree_3k.hdr",GCanyon:"/envMaps/GCanyon_C_YumaPoint_3k.hdr",Milkyway:"/envMaps/Milkyway_small.hdr",Studio:"/envMaps/studio_small_02_2k.hdr",Royal:"/envMaps/royal_esplanade_1k.hdr"},Po={CornellBox:"/models/cornellBox/scene.gltf",DamagedHelmet:"/models/DamagedHelmet/scene.gltf",Dragon:"/models/Dragon/dragon.glb",DragonDraco:"/models/Dragon/dragonDraco.glb",Duck:"/models/Duck/gltf/Duck.gltf",TwoDuck:"/models/twoDuck/scene.gltf",Miku:"/models/miku2/scene.gltf",DiningRoom:"/models/DiningRoom/scene.gltf",MaterialBall:"/models/ball/scene.gltf",dracoDishModelPath:"/models/draco/IridescentDishWithOlives.glb",Car:"/models/car/scene.gltf",TeapotDraco:"/models/teapot/teapotDraco.glb",Zelda:"/models/zelda/scene.gltf",SG:"/models/SpecGlossVsMetalRough/scene.gltf",SSSDragon:"/models/SSS/Dragon/scene.gltf",SSSDragonDraco:"/models/SSS/Dragon/dragonDraco.glb",FlightHelmet:"/models/FlightHelmet/scene.gltf",Bug1:"/models/bug/transform/TextureTransformTest.gltf",Bug2:"/models/bug/blackBug/blackBug.gltf",Bug3:"/models/bug/blackBug1/blackBug.gltf",Bug4:"/models/bug/Smeg/scene.glb",Shoe:"/models/shoe/used_new_balance_574_classic______free/scene.gltf",FantasyBook:"/models/FantasyBook/scene.gltf",Shoe4D:"/models/4dShoe/shoe.glb",Pica:"/models/Pica/scene.gltf",uv:"/models/uv/uv.glb"},Do="/models/diningRoom/scene.gltf",Fo="/models/diningRoom/diningRoom.glb",No="/models/Stormtrooper/stormtrooper.glb";var Te=function(){var s=0,e=document.createElement("div");e.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",e.addEventListener("click",function(l){l.preventDefault(),n(++s%e.children.length)},!1);function t(l){return e.appendChild(l.dom),l}function n(l){for(var d=0;d<e.children.length;d++)e.children[d].style.display=d===l?"block":"none";s=l}var i=(performance||Date).now(),o=i,r=0,a=t(new Te.Panel("FPS","#0ff","#002")),c=t(new Te.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var u=t(new Te.Panel("MB","#f08","#201"));return n(0),{REVISION:16,dom:e,addPanel:t,showPanel:n,begin:function(){i=(performance||Date).now()},end:function(){r++;var l=(performance||Date).now();if(c.update(l-i,200),l>=o+1e3&&(a.update(r*1e3/(l-o),100),o=l,r=0,u)){var d=performance.memory;u.update(d.usedJSHeapSize/1048576,d.jsHeapSizeLimit/1048576)}return l},update:function(){i=this.end()},domElement:e,setMode:n}};Te.Panel=function(s,e,t){var n=1/0,i=0,o=Math.round,r=o(window.devicePixelRatio||1),a=80*r,c=48*r,u=3*r,l=2*r,d=3*r,f=15*r,m=74*r,y=30*r,_=document.createElement("canvas");_.width=a,_.height=c,_.style.cssText="width:80px;height:48px";var g=_.getContext("2d");return g.font="bold "+9*r+"px Helvetica,Arial,sans-serif",g.textBaseline="top",g.fillStyle=t,g.fillRect(0,0,a,c),g.fillStyle=e,g.fillText(s,u,l),g.fillRect(d,f,m,y),g.fillStyle=t,g.globalAlpha=.9,g.fillRect(d,f,m,y),{dom:_,update:function(v,w){n=Math.min(n,v),i=Math.max(i,v),g.fillStyle=t,g.globalAlpha=1,g.fillRect(0,0,a,f),g.fillStyle=e,g.fillText(o(v)+" "+s+" ("+o(n)+"-"+o(i)+")",u,l),g.drawImage(_,d+r,f,m-r,y,d,f,m-r,y),g.fillRect(d+m-r,f,r,y),g.fillStyle=t,g.globalAlpha=.9,g.fillRect(d+m-r,f,r,o((1-v/w)*y))}}};function Ws(s){if(!!s&&typeof window!="undefined"){var e=document.createElement("style");return e.setAttribute("type","text/css"),e.innerHTML=s,document.head.appendChild(e),s}}function ge(s,e){var t=s.__state.conversionName.toString(),n=Math.round(s.r),i=Math.round(s.g),o=Math.round(s.b),r=s.a,a=Math.round(s.h),c=s.s.toFixed(1),u=s.v.toFixed(1);if(e||t==="THREE_CHAR_HEX"||t==="SIX_CHAR_HEX"){for(var l=s.hex.toString(16);l.length<6;)l="0"+l;return"#"+l}else{if(t==="CSS_RGB")return"rgb("+n+","+i+","+o+")";if(t==="CSS_RGBA")return"rgba("+n+","+i+","+o+","+r+")";if(t==="HEX")return"0x"+s.hex.toString(16);if(t==="RGB_ARRAY")return"["+n+","+i+","+o+"]";if(t==="RGBA_ARRAY")return"["+n+","+i+","+o+","+r+"]";if(t==="RGB_OBJ")return"{r:"+n+",g:"+i+",b:"+o+"}";if(t==="RGBA_OBJ")return"{r:"+n+",g:"+i+",b:"+o+",a:"+r+"}";if(t==="HSV_OBJ")return"{h:"+a+",s:"+c+",v:"+u+"}";if(t==="HSVA_OBJ")return"{h:"+a+",s:"+c+",v:"+u+",a:"+r+"}"}return"unknown format"}var Jt=Array.prototype.forEach,we=Array.prototype.slice,E={BREAK:{},extend:function(e){return this.each(we.call(arguments,1),function(t){var n=this.isObject(t)?Object.keys(t):[];n.forEach(function(i){this.isUndefined(t[i])||(e[i]=t[i])}.bind(this))},this),e},defaults:function(e){return this.each(we.call(arguments,1),function(t){var n=this.isObject(t)?Object.keys(t):[];n.forEach(function(i){this.isUndefined(e[i])&&(e[i]=t[i])}.bind(this))},this),e},compose:function(){var e=we.call(arguments);return function(){for(var t=we.call(arguments),n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},each:function(e,t,n){if(!!e){if(Jt&&e.forEach&&e.forEach===Jt)e.forEach(t,n);else if(e.length===e.length+0){var i=void 0,o=void 0;for(i=0,o=e.length;i<o;i++)if(i in e&&t.call(n,e[i],i)===this.BREAK)return}else for(var r in e)if(t.call(n,e[r],r)===this.BREAK)return}},defer:function(e){setTimeout(e,0)},debounce:function(e,t,n){var i=void 0;return function(){var o=this,r=arguments;function a(){i=null,n||e.apply(o,r)}var c=n||!i;clearTimeout(i),i=setTimeout(a,t),c&&e.apply(o,r)}},toArray:function(e){return e.toArray?e.toArray():we.call(e)},isUndefined:function(e){return e===void 0},isNull:function(e){return e===null},isNaN:function(s){function e(){return s.apply(this,arguments)}return e.toString=function(){return s.toString()},e}(function(s){return isNaN(s)}),isArray:Array.isArray||function(s){return s.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return e===!1||e===!0},isFunction:function(e){return e instanceof Function}},$s=[{litmus:E.isString,conversions:{THREE_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return t===null?!1:{space:"HEX",hex:parseInt("0x"+t[1].toString()+t[1].toString()+t[2].toString()+t[2].toString()+t[3].toString()+t[3].toString(),0)}},write:ge},SIX_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9]{6})$/i);return t===null?!1:{space:"HEX",hex:parseInt("0x"+t[1].toString(),0)}},write:ge},CSS_RGB:{read:function(e){var t=e.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return t===null?!1:{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3])}},write:ge},CSS_RGBA:{read:function(e){var t=e.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return t===null?!1:{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3]),a:parseFloat(t[4])}},write:ge}}},{litmus:E.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:E.isArray,conversions:{RGB_ARRAY:{read:function(e){return e.length!==3?!1:{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return e.length!==4?!1:{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:E.isObject,conversions:{RGBA_OBJ:{read:function(e){return E.isNumber(e.r)&&E.isNumber(e.g)&&E.isNumber(e.b)&&E.isNumber(e.a)?{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}:!1},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return E.isNumber(e.r)&&E.isNumber(e.g)&&E.isNumber(e.b)?{space:"RGB",r:e.r,g:e.g,b:e.b}:!1},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return E.isNumber(e.h)&&E.isNumber(e.s)&&E.isNumber(e.v)&&E.isNumber(e.a)?{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}:!1},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return E.isNumber(e.h)&&E.isNumber(e.s)&&E.isNumber(e.v)?{space:"HSV",h:e.h,s:e.s,v:e.v}:!1},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}],xe=void 0,Ge=void 0,tt=function(){Ge=!1;var e=arguments.length>1?E.toArray(arguments):arguments[0];return E.each($s,function(t){if(t.litmus(e))return E.each(t.conversions,function(n,i){if(xe=n.read(e),Ge===!1&&xe!==!1)return Ge=xe,xe.conversionName=i,xe.conversion=n,E.BREAK}),E.BREAK}),Ge},Zt=void 0,Ve={hsv_to_rgb:function(e,t,n){var i=Math.floor(e/60)%6,o=e/60-Math.floor(e/60),r=n*(1-t),a=n*(1-o*t),c=n*(1-(1-o)*t),u=[[n,c,r],[a,n,r],[r,n,c],[r,a,n],[c,r,n],[n,r,a]][i];return{r:u[0]*255,g:u[1]*255,b:u[2]*255}},rgb_to_hsv:function(e,t,n){var i=Math.min(e,t,n),o=Math.max(e,t,n),r=o-i,a=void 0,c=void 0;if(o!==0)c=r/o;else return{h:NaN,s:0,v:0};return e===o?a=(t-n)/r:t===o?a=2+(n-e)/r:a=4+(e-t)/r,a/=6,a<0&&(a+=1),{h:a*360,s:c,v:o/255}},rgb_to_hex:function(e,t,n){var i=this.hex_with_component(0,2,e);return i=this.hex_with_component(i,1,t),i=this.hex_with_component(i,0,n),i},component_from_hex:function(e,t){return e>>t*8&255},hex_with_component:function(e,t,n){return n<<(Zt=t*8)|e&~(255<<Zt)}},qs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},W=function(s,e){if(!(s instanceof e))throw new TypeError("Cannot call a class as a function")},$=function(){function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),e}}(),se=function s(e,t,n){e===null&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,t);if(i===void 0){var o=Object.getPrototypeOf(e);return o===null?void 0:s(o,t,n)}else{if("value"in i)return i.value;var r=i.get;return r===void 0?void 0:r.call(n)}},ie=function(s,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);s.prototype=Object.create(e&&e.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(s,e):s.__proto__=e)},oe=function(s,e){if(!s)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:s},U=function(){function s(){if(W(this,s),this.__state=tt.apply(this,arguments),this.__state===!1)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return $(s,[{key:"toString",value:function(){return ge(this)}},{key:"toHexString",value:function(){return ge(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),s}();function nt(s,e,t){Object.defineProperty(s,e,{get:function(){return this.__state.space==="RGB"?this.__state[e]:(U.recalculateRGB(this,e,t),this.__state[e])},set:function(i){this.__state.space!=="RGB"&&(U.recalculateRGB(this,e,t),this.__state.space="RGB"),this.__state[e]=i}})}function st(s,e){Object.defineProperty(s,e,{get:function(){return this.__state.space==="HSV"?this.__state[e]:(U.recalculateHSV(this),this.__state[e])},set:function(n){this.__state.space!=="HSV"&&(U.recalculateHSV(this),this.__state.space="HSV"),this.__state[e]=n}})}U.recalculateRGB=function(s,e,t){if(s.__state.space==="HEX")s.__state[e]=Ve.component_from_hex(s.__state.hex,t);else if(s.__state.space==="HSV")E.extend(s.__state,Ve.hsv_to_rgb(s.__state.h,s.__state.s,s.__state.v));else throw new Error("Corrupted color state")};U.recalculateHSV=function(s){var e=Ve.rgb_to_hsv(s.r,s.g,s.b);E.extend(s.__state,{s:e.s,v:e.v}),E.isNaN(e.h)?E.isUndefined(s.__state.h)&&(s.__state.h=0):s.__state.h=e.h};U.COMPONENTS=["r","g","b","h","s","v","hex","a"];nt(U.prototype,"r",2);nt(U.prototype,"g",1);nt(U.prototype,"b",0);st(U.prototype,"h");st(U.prototype,"s");st(U.prototype,"v");Object.defineProperty(U.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}});Object.defineProperty(U.prototype,"hex",{get:function(){return this.__state.space!=="HEX"&&(this.__state.hex=Ve.rgb_to_hex(this.r,this.g,this.b),this.__state.space="HEX"),this.__state.hex},set:function(e){this.__state.space="HEX",this.__state.hex=e}});var le=function(){function s(e,t){W(this,s),this.initialValue=e[t],this.domElement=document.createElement("div"),this.object=e,this.property=t,this.__onChange=void 0,this.__onFinishChange=void 0}return $(s,[{key:"onChange",value:function(t){return this.__onChange=t,this}},{key:"onFinishChange",value:function(t){return this.__onFinishChange=t,this}},{key:"setValue",value:function(t){return this.object[this.property]=t,this.__onChange&&this.__onChange.call(this,t),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),s}(),Qs={HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},en={};E.each(Qs,function(s,e){E.each(s,function(t){en[t]=e})});var Js=/(\d+(\.\d+)?)px/;function Q(s){if(s==="0"||E.isUndefined(s))return 0;var e=s.match(Js);return E.isNull(e)?0:parseFloat(e[1])}var p={makeSelectable:function(e,t){e===void 0||e.style===void 0||(e.onselectstart=t?function(){return!1}:function(){},e.style.MozUserSelect=t?"auto":"none",e.style.KhtmlUserSelect=t?"auto":"none",e.unselectable=t?"on":"off")},makeFullscreen:function(e,t,n){var i=n,o=t;E.isUndefined(o)&&(o=!0),E.isUndefined(i)&&(i=!0),e.style.position="absolute",o&&(e.style.left=0,e.style.right=0),i&&(e.style.top=0,e.style.bottom=0)},fakeEvent:function(e,t,n,i){var o=n||{},r=en[t];if(!r)throw new Error("Event type "+t+" not supported.");var a=document.createEvent(r);switch(r){case"MouseEvents":{var c=o.x||o.clientX||0,u=o.y||o.clientY||0;a.initMouseEvent(t,o.bubbles||!1,o.cancelable||!0,window,o.clickCount||1,0,0,c,u,!1,!1,!1,!1,0,null);break}case"KeyboardEvents":{var l=a.initKeyboardEvent||a.initKeyEvent;E.defaults(o,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),l(t,o.bubbles||!1,o.cancelable,window,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.keyCode,o.charCode);break}default:{a.initEvent(t,o.bubbles||!1,o.cancelable||!0);break}}E.defaults(a,i),e.dispatchEvent(a)},bind:function(e,t,n,i){var o=i||!1;return e.addEventListener?e.addEventListener(t,n,o):e.attachEvent&&e.attachEvent("on"+t,n),p},unbind:function(e,t,n,i){var o=i||!1;return e.removeEventListener?e.removeEventListener(t,n,o):e.detachEvent&&e.detachEvent("on"+t,n),p},addClass:function(e,t){if(e.className===void 0)e.className=t;else if(e.className!==t){var n=e.className.split(/ +/);n.indexOf(t)===-1&&(n.push(t),e.className=n.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return p},removeClass:function(e,t){if(t)if(e.className===t)e.removeAttribute("class");else{var n=e.className.split(/ +/),i=n.indexOf(t);i!==-1&&(n.splice(i,1),e.className=n.join(" "))}else e.className=void 0;return p},hasClass:function(e,t){return new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(e.className)||!1},getWidth:function(e){var t=getComputedStyle(e);return Q(t["border-left-width"])+Q(t["border-right-width"])+Q(t["padding-left"])+Q(t["padding-right"])+Q(t.width)},getHeight:function(e){var t=getComputedStyle(e);return Q(t["border-top-width"])+Q(t["border-bottom-width"])+Q(t["padding-top"])+Q(t["padding-bottom"])+Q(t.height)},getOffset:function(e){var t=e,n={left:0,top:0};if(t.offsetParent)do n.left+=t.offsetLeft,n.top+=t.offsetTop,t=t.offsetParent;while(t);return n},isActive:function(e){return e===document.activeElement&&(e.type||e.href)}},tn=function(s){ie(e,s);function e(t,n){W(this,e);var i=oe(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n)),o=i;i.__prev=i.getValue(),i.__checkbox=document.createElement("input"),i.__checkbox.setAttribute("type","checkbox");function r(){o.setValue(!o.__prev)}return p.bind(i.__checkbox,"change",r,!1),i.domElement.appendChild(i.__checkbox),i.updateDisplay(),i}return $(e,[{key:"setValue",value:function(n){var i=se(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,n);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),i}},{key:"updateDisplay",value:function(){return this.getValue()===!0?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),se(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(le),Zs=function(s){ie(e,s);function e(t,n,i){W(this,e);var o=oe(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n)),r=i,a=o;if(o.__select=document.createElement("select"),E.isArray(r)){var c={};E.each(r,function(u){c[u]=u}),r=c}return E.each(r,function(u,l){var d=document.createElement("option");d.innerHTML=l,d.setAttribute("value",u),a.__select.appendChild(d)}),o.updateDisplay(),p.bind(o.__select,"change",function(){var u=this.options[this.selectedIndex].value;a.setValue(u)}),o.domElement.appendChild(o.__select),o}return $(e,[{key:"setValue",value:function(n){var i=se(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,n);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),i}},{key:"updateDisplay",value:function(){return p.isActive(this.__select)?this:(this.__select.value=this.getValue(),se(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this))}}]),e}(le),ei=function(s){ie(e,s);function e(t,n){W(this,e);var i=oe(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n)),o=i;function r(){o.setValue(o.__input.value)}function a(){o.__onFinishChange&&o.__onFinishChange.call(o,o.getValue())}return i.__input=document.createElement("input"),i.__input.setAttribute("type","text"),p.bind(i.__input,"keyup",r),p.bind(i.__input,"change",r),p.bind(i.__input,"blur",a),p.bind(i.__input,"keydown",function(c){c.keyCode===13&&this.blur()}),i.updateDisplay(),i.domElement.appendChild(i.__input),i}return $(e,[{key:"updateDisplay",value:function(){return p.isActive(this.__input)||(this.__input.value=this.getValue()),se(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(le);function nn(s){var e=s.toString();return e.indexOf(".")>-1?e.length-e.indexOf(".")-1:0}var sn=function(s){ie(e,s);function e(t,n,i){W(this,e);var o=oe(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n)),r=i||{};return o.__min=r.min,o.__max=r.max,o.__step=r.step,E.isUndefined(o.__step)?o.initialValue===0?o.__impliedStep=1:o.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(o.initialValue))/Math.LN10))/10:o.__impliedStep=o.__step,o.__precision=nn(o.__impliedStep),o}return $(e,[{key:"setValue",value:function(n){var i=n;return this.__min!==void 0&&i<this.__min?i=this.__min:this.__max!==void 0&&i>this.__max&&(i=this.__max),this.__step!==void 0&&i%this.__step!=0&&(i=Math.round(i/this.__step)*this.__step),se(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,i)}},{key:"min",value:function(n){return this.__min=n,this}},{key:"max",value:function(n){return this.__max=n,this}},{key:"step",value:function(n){return this.__step=n,this.__impliedStep=n,this.__precision=nn(n),this}}]),e}(le);function ti(s,e){var t=Math.pow(10,e);return Math.round(s*t)/t}var je=function(s){ie(e,s);function e(t,n,i){W(this,e);var o=oe(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,i));o.__truncationSuspended=!1;var r=o,a=void 0;function c(){var y=parseFloat(r.__input.value);E.isNaN(y)||r.setValue(y)}function u(){r.__onFinishChange&&r.__onFinishChange.call(r,r.getValue())}function l(){u()}function d(y){var _=a-y.clientY;r.setValue(r.getValue()+_*r.__impliedStep),a=y.clientY}function f(){p.unbind(window,"mousemove",d),p.unbind(window,"mouseup",f),u()}function m(y){p.bind(window,"mousemove",d),p.bind(window,"mouseup",f),a=y.clientY}return o.__input=document.createElement("input"),o.__input.setAttribute("type","text"),p.bind(o.__input,"change",c),p.bind(o.__input,"blur",l),p.bind(o.__input,"mousedown",m),p.bind(o.__input,"keydown",function(y){y.keyCode===13&&(r.__truncationSuspended=!0,this.blur(),r.__truncationSuspended=!1,u())}),o.updateDisplay(),o.domElement.appendChild(o.__input),o}return $(e,[{key:"updateDisplay",value:function(){return this.__input.value=this.__truncationSuspended?this.getValue():ti(this.getValue(),this.__precision),se(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(sn);function on(s,e,t,n,i){return n+(i-n)*((s-e)/(t-e))}var it=function(s){ie(e,s);function e(t,n,i,o,r){W(this,e);var a=oe(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,{min:i,max:o,step:r})),c=a;a.__background=document.createElement("div"),a.__foreground=document.createElement("div"),p.bind(a.__background,"mousedown",u),p.bind(a.__background,"touchstart",f),p.addClass(a.__background,"slider"),p.addClass(a.__foreground,"slider-fg");function u(_){document.activeElement.blur(),p.bind(window,"mousemove",l),p.bind(window,"mouseup",d),l(_)}function l(_){_.preventDefault();var g=c.__background.getBoundingClientRect();return c.setValue(on(_.clientX,g.left,g.right,c.__min,c.__max)),!1}function d(){p.unbind(window,"mousemove",l),p.unbind(window,"mouseup",d),c.__onFinishChange&&c.__onFinishChange.call(c,c.getValue())}function f(_){_.touches.length===1&&(p.bind(window,"touchmove",m),p.bind(window,"touchend",y),m(_))}function m(_){var g=_.touches[0].clientX,v=c.__background.getBoundingClientRect();c.setValue(on(g,v.left,v.right,c.__min,c.__max))}function y(){p.unbind(window,"touchmove",m),p.unbind(window,"touchend",y),c.__onFinishChange&&c.__onFinishChange.call(c,c.getValue())}return a.updateDisplay(),a.__background.appendChild(a.__foreground),a.domElement.appendChild(a.__background),a}return $(e,[{key:"updateDisplay",value:function(){var n=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=n*100+"%",se(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(sn),rn=function(s){ie(e,s);function e(t,n,i){W(this,e);var o=oe(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n)),r=o;return o.__button=document.createElement("div"),o.__button.innerHTML=i===void 0?"Fire":i,p.bind(o.__button,"click",function(a){return a.preventDefault(),r.fire(),!1}),p.addClass(o.__button,"button"),o.domElement.appendChild(o.__button),o}return $(e,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),e}(le),ot=function(s){ie(e,s);function e(t,n){W(this,e);var i=oe(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));i.__color=new U(i.getValue()),i.__temp=new U(0);var o=i;i.domElement=document.createElement("div"),p.makeSelectable(i.domElement,!1),i.__selector=document.createElement("div"),i.__selector.className="selector",i.__saturation_field=document.createElement("div"),i.__saturation_field.className="saturation-field",i.__field_knob=document.createElement("div"),i.__field_knob.className="field-knob",i.__field_knob_border="2px solid ",i.__hue_knob=document.createElement("div"),i.__hue_knob.className="hue-knob",i.__hue_field=document.createElement("div"),i.__hue_field.className="hue-field",i.__input=document.createElement("input"),i.__input.type="text",i.__input_textShadow="0 1px 1px ",p.bind(i.__input,"keydown",function(_){_.keyCode===13&&d.call(this)}),p.bind(i.__input,"blur",d),p.bind(i.__selector,"mousedown",function(){p.addClass(this,"drag").bind(window,"mouseup",function(){p.removeClass(o.__selector,"drag")})}),p.bind(i.__selector,"touchstart",function(){p.addClass(this,"drag").bind(window,"touchend",function(){p.removeClass(o.__selector,"drag")})});var r=document.createElement("div");E.extend(i.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),E.extend(i.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:i.__field_knob_border+(i.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),E.extend(i.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),E.extend(i.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),E.extend(r.style,{width:"100%",height:"100%",background:"none"}),an(r,"top","rgba(0,0,0,0)","#000"),E.extend(i.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),si(i.__hue_field),E.extend(i.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:i.__input_textShadow+"rgba(0,0,0,0.7)"}),p.bind(i.__saturation_field,"mousedown",a),p.bind(i.__saturation_field,"touchstart",a),p.bind(i.__field_knob,"mousedown",a),p.bind(i.__field_knob,"touchstart",a),p.bind(i.__hue_field,"mousedown",c),p.bind(i.__hue_field,"touchstart",c);function a(_){m(_),p.bind(window,"mousemove",m),p.bind(window,"touchmove",m),p.bind(window,"mouseup",u),p.bind(window,"touchend",u)}function c(_){y(_),p.bind(window,"mousemove",y),p.bind(window,"touchmove",y),p.bind(window,"mouseup",l),p.bind(window,"touchend",l)}function u(){p.unbind(window,"mousemove",m),p.unbind(window,"touchmove",m),p.unbind(window,"mouseup",u),p.unbind(window,"touchend",u),f()}function l(){p.unbind(window,"mousemove",y),p.unbind(window,"touchmove",y),p.unbind(window,"mouseup",l),p.unbind(window,"touchend",l),f()}function d(){var _=tt(this.value);_!==!1?(o.__color.__state=_,o.setValue(o.__color.toOriginal())):this.value=o.__color.toString()}function f(){o.__onFinishChange&&o.__onFinishChange.call(o,o.__color.toOriginal())}i.__saturation_field.appendChild(r),i.__selector.appendChild(i.__field_knob),i.__selector.appendChild(i.__saturation_field),i.__selector.appendChild(i.__hue_field),i.__hue_field.appendChild(i.__hue_knob),i.domElement.appendChild(i.__input),i.domElement.appendChild(i.__selector),i.updateDisplay();function m(_){_.type.indexOf("touch")===-1&&_.preventDefault();var g=o.__saturation_field.getBoundingClientRect(),v=_.touches&&_.touches[0]||_,w=v.clientX,T=v.clientY,x=(w-g.left)/(g.right-g.left),b=1-(T-g.top)/(g.bottom-g.top);return b>1?b=1:b<0&&(b=0),x>1?x=1:x<0&&(x=0),o.__color.v=b,o.__color.s=x,o.setValue(o.__color.toOriginal()),!1}function y(_){_.type.indexOf("touch")===-1&&_.preventDefault();var g=o.__hue_field.getBoundingClientRect(),v=_.touches&&_.touches[0]||_,w=v.clientY,T=1-(w-g.top)/(g.bottom-g.top);return T>1?T=1:T<0&&(T=0),o.__color.h=T*360,o.setValue(o.__color.toOriginal()),!1}return i}return $(e,[{key:"updateDisplay",value:function(){var n=tt(this.getValue());if(n!==!1){var i=!1;E.each(U.COMPONENTS,function(a){if(!E.isUndefined(n[a])&&!E.isUndefined(this.__color.__state[a])&&n[a]!==this.__color.__state[a])return i=!0,{}},this),i&&E.extend(this.__color.__state,n)}E.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var o=this.__color.v<.5||this.__color.s>.5?255:0,r=255-o;E.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+o+","+o+","+o+")"}),this.__hue_knob.style.marginTop=(1-this.__color.h/360)*100+"px",this.__temp.s=1,this.__temp.v=1,an(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),E.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+o+","+o+","+o+")",textShadow:this.__input_textShadow+"rgba("+r+","+r+","+r+",.7)"})}}]),e}(le),ni=["-moz-","-o-","-webkit-","-ms-",""];function an(s,e,t,n){s.style.background="",E.each(ni,function(i){s.style.cssText+="background: "+i+"linear-gradient("+e+", "+t+" 0%, "+n+" 100%); "})}function si(s){s.style.background="",s.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",s.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",s.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",s.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",s.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}var ii={load:function(e,t){var n=t||document,i=n.createElement("link");i.type="text/css",i.rel="stylesheet",i.href=e,n.getElementsByTagName("head")[0].appendChild(i)},inject:function(e,t){var n=t||document,i=document.createElement("style");i.type="text/css",i.innerHTML=e;var o=n.getElementsByTagName("head")[0];try{o.appendChild(i)}catch{}}},oi=`<div id="dg-save" class="dg dialogue">

  Here's the new load parameter for your <code>GUI</code>'s constructor:

  <textarea id="dg-new-constructor"></textarea>

  <div id="dg-save-locally">

    <input id="dg-local-storage" type="checkbox"/> Automatically save
    values to <code>localStorage</code> on exit.

    <div id="dg-local-explain">The values saved to <code>localStorage</code> will
      override those passed to <code>dat.GUI</code>'s constructor. This makes it
      easier to work incrementally, but <code>localStorage</code> is fragile,
      and your friends may not see the same values you do.

    </div>

  </div>

</div>`,ri=function(e,t){var n=e[t];return E.isArray(arguments[2])||E.isObject(arguments[2])?new Zs(e,t,arguments[2]):E.isNumber(n)?E.isNumber(arguments[2])&&E.isNumber(arguments[3])?E.isNumber(arguments[4])?new it(e,t,arguments[2],arguments[3],arguments[4]):new it(e,t,arguments[2],arguments[3]):E.isNumber(arguments[4])?new je(e,t,{min:arguments[2],max:arguments[3],step:arguments[4]}):new je(e,t,{min:arguments[2],max:arguments[3]}):E.isString(n)?new ei(e,t):E.isFunction(n)?new rn(e,t,""):E.isBoolean(n)?new tn(e,t):null};function ai(s){setTimeout(s,1e3/60)}var ci=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||ai,li=function(){function s(){W(this,s),this.backgroundElement=document.createElement("div"),E.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),p.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),E.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var e=this;p.bind(this.backgroundElement,"click",function(){e.hide()})}return $(s,[{key:"show",value:function(){var t=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),E.defer(function(){t.backgroundElement.style.opacity=1,t.domElement.style.opacity=1,t.domElement.style.webkitTransform="scale(1)"})}},{key:"hide",value:function(){var t=this,n=function i(){t.domElement.style.display="none",t.backgroundElement.style.display="none",p.unbind(t.domElement,"webkitTransitionEnd",i),p.unbind(t.domElement,"transitionend",i),p.unbind(t.domElement,"oTransitionEnd",i)};p.bind(this.domElement,"webkitTransitionEnd",n),p.bind(this.domElement,"transitionend",n),p.bind(this.domElement,"oTransitionEnd",n),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-p.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-p.getHeight(this.domElement)/2+"px"}}]),s}(),ui=Ws(`.dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}
`);ii.inject(ui);var cn="dg",ln=72,un=20,Ae="Default",Se=function(){try{return!!window.localStorage}catch{return!1}}(),Re=void 0,dn=!0,be=void 0,rt=!1,fn=[],F=function s(e){var t=this,n=e||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),p.addClass(this.domElement,cn),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],n=E.defaults(n,{closeOnTop:!1,autoPlace:!0,width:s.DEFAULT_WIDTH}),n=E.defaults(n,{resizable:n.autoPlace,hideable:n.autoPlace}),E.isUndefined(n.load)?n.load={preset:Ae}:n.preset&&(n.load.preset=n.preset),E.isUndefined(n.parent)&&n.hideable&&fn.push(this),n.resizable=E.isUndefined(n.parent)&&n.resizable,n.autoPlace&&E.isUndefined(n.scrollable)&&(n.scrollable=!0);var i=Se&&localStorage.getItem(ye(this,"isLocal"))==="true",o=void 0,r=void 0;if(Object.defineProperties(this,{parent:{get:function(){return n.parent}},scrollable:{get:function(){return n.scrollable}},autoPlace:{get:function(){return n.autoPlace}},closeOnTop:{get:function(){return n.closeOnTop}},preset:{get:function(){return t.parent?t.getRoot().preset:n.load.preset},set:function(f){t.parent?t.getRoot().preset=f:n.load.preset=f,pi(this),t.revert()}},width:{get:function(){return n.width},set:function(f){n.width=f,ut(t,f)}},name:{get:function(){return n.name},set:function(f){n.name=f,r&&(r.innerHTML=n.name)}},closed:{get:function(){return n.closed},set:function(f){n.closed=f,n.closed?p.addClass(t.__ul,s.CLASS_CLOSED):p.removeClass(t.__ul,s.CLASS_CLOSED),this.onResize(),t.__closeButton&&(t.__closeButton.innerHTML=f?s.TEXT_OPEN:s.TEXT_CLOSED)}},load:{get:function(){return n.load}},useLocalStorage:{get:function(){return i},set:function(f){Se&&(i=f,f?p.bind(window,"unload",o):p.unbind(window,"unload",o),localStorage.setItem(ye(t,"isLocal"),f))}}}),E.isUndefined(n.parent)){if(this.closed=n.closed||!1,p.addClass(this.domElement,s.CLASS_MAIN),p.makeSelectable(this.domElement,!1),Se&&i){t.useLocalStorage=!0;var a=localStorage.getItem(ye(this,"gui"));a&&(n.load=JSON.parse(a))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=s.TEXT_CLOSED,p.addClass(this.__closeButton,s.CLASS_CLOSE_BUTTON),n.closeOnTop?(p.addClass(this.__closeButton,s.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(p.addClass(this.__closeButton,s.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),p.bind(this.__closeButton,"click",function(){t.closed=!t.closed})}else{n.closed===void 0&&(n.closed=!0);var c=document.createTextNode(n.name);p.addClass(c,"controller-name"),r=at(t,c);var u=function(f){return f.preventDefault(),t.closed=!t.closed,!1};p.addClass(this.__ul,s.CLASS_CLOSED),p.addClass(r,"title"),p.bind(r,"click",u),n.closed||(this.closed=!1)}n.autoPlace&&(E.isUndefined(n.parent)&&(dn&&(be=document.createElement("div"),p.addClass(be,cn),p.addClass(be,s.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(be),dn=!1),be.appendChild(this.domElement),p.addClass(this.domElement,s.CLASS_AUTO_PLACE)),this.parent||ut(t,n.width)),this.__resizeHandler=function(){t.onResizeDebounced()},p.bind(window,"resize",this.__resizeHandler),p.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),p.bind(this.__ul,"transitionend",this.__resizeHandler),p.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),n.resizable&&hi(this),o=function(){Se&&localStorage.getItem(ye(t,"isLocal"))==="true"&&localStorage.setItem(ye(t,"gui"),JSON.stringify(t.getSaveObject()))},this.saveToLocalStorageIfPossible=o;function l(){var d=t.getRoot();d.width+=1,E.defer(function(){d.width-=1})}n.parent||l()};F.toggleHide=function(){rt=!rt,E.each(fn,function(s){s.domElement.style.display=rt?"none":""})};F.CLASS_AUTO_PLACE="a";F.CLASS_AUTO_PLACE_CONTAINER="ac";F.CLASS_MAIN="main";F.CLASS_CONTROLLER_ROW="cr";F.CLASS_TOO_TALL="taller-than-window";F.CLASS_CLOSED="closed";F.CLASS_CLOSE_BUTTON="close-button";F.CLASS_CLOSE_TOP="close-top";F.CLASS_CLOSE_BOTTOM="close-bottom";F.CLASS_DRAG="drag";F.DEFAULT_WIDTH=245;F.TEXT_CLOSED="Close Controls";F.TEXT_OPEN="Open Controls";F._keydownHandler=function(s){document.activeElement.type!=="text"&&(s.which===ln||s.keyCode===ln)&&F.toggleHide()};p.bind(window,"keydown",F._keydownHandler,!1);E.extend(F.prototype,{add:function(e,t){return Le(this,e,t,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(e,t){return Le(this,e,t,{color:!0})},remove:function(e){this.__ul.removeChild(e.__li),this.__controllers.splice(this.__controllers.indexOf(e),1);var t=this;E.defer(function(){t.onResize()})},destroy:function(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&be.removeChild(this.domElement);var e=this;E.each(this.__folders,function(t){e.removeFolder(t)}),p.unbind(window,"keydown",F._keydownHandler,!1),hn(this)},addFolder:function(e){if(this.__folders[e]!==void 0)throw new Error('You already have a folder in this GUI by the name "'+e+'"');var t={name:e,parent:this};t.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[e]&&(t.closed=this.load.folders[e].closed,t.load=this.load.folders[e]);var n=new F(t);this.__folders[e]=n;var i=at(this,n.domElement);return p.addClass(i,"folder"),n},removeFolder:function(e){this.__ul.removeChild(e.domElement.parentElement),delete this.__folders[e.name],this.load&&this.load.folders&&this.load.folders[e.name]&&delete this.load.folders[e.name],hn(e);var t=this;E.each(e.__folders,function(n){e.removeFolder(n)}),E.defer(function(){t.onResize()})},open:function(){this.closed=!1},close:function(){this.closed=!0},hide:function(){this.domElement.style.display="none"},show:function(){this.domElement.style.display=""},onResize:function(){var e=this.getRoot();if(e.scrollable){var t=p.getOffset(e.__ul).top,n=0;E.each(e.__ul.childNodes,function(i){e.autoPlace&&i===e.__save_row||(n+=p.getHeight(i))}),window.innerHeight-t-un<n?(p.addClass(e.domElement,F.CLASS_TOO_TALL),e.__ul.style.height=window.innerHeight-t-un+"px"):(p.removeClass(e.domElement,F.CLASS_TOO_TALL),e.__ul.style.height="auto")}e.__resize_handle&&E.defer(function(){e.__resize_handle.style.height=e.__ul.offsetHeight+"px"}),e.__closeButton&&(e.__closeButton.style.width=e.width+"px")},onResizeDebounced:E.debounce(function(){this.onResize()},50),remember:function(){if(E.isUndefined(Re)&&(Re=new li,Re.domElement.innerHTML=oi),this.parent)throw new Error("You can only call remember on a top level GUI.");var e=this;E.each(Array.prototype.slice.call(arguments),function(t){e.__rememberedObjects.length===0&&fi(e),e.__rememberedObjects.indexOf(t)===-1&&e.__rememberedObjects.push(t)}),this.autoPlace&&ut(this,this.width)},getRoot:function(){for(var e=this;e.parent;)e=e.parent;return e},getSaveObject:function(){var e=this.load;return e.closed=this.closed,this.__rememberedObjects.length>0&&(e.preset=this.preset,e.remembered||(e.remembered={}),e.remembered[this.preset]=ze(this)),e.folders={},E.each(this.__folders,function(t,n){e.folders[n]=t.getSaveObject()}),e},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=ze(this),ct(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(e){this.load.remembered||(this.load.remembered={},this.load.remembered[Ae]=ze(this,!0)),this.load.remembered[e]=ze(this),this.preset=e,lt(this,e,!0),this.saveToLocalStorageIfPossible()},revert:function(e){E.each(this.__controllers,function(t){this.getRoot().load.remembered?pn(e||this.getRoot(),t):t.setValue(t.initialValue),t.__onFinishChange&&t.__onFinishChange.call(t,t.getValue())},this),E.each(this.__folders,function(t){t.revert(t)}),e||ct(this.getRoot(),!1)},listen:function(e){var t=this.__listening.length===0;this.__listening.push(e),t&&_n(this.__listening)},updateDisplay:function(){E.each(this.__controllers,function(e){e.updateDisplay()}),E.each(this.__folders,function(e){e.updateDisplay()})}});function at(s,e,t){var n=document.createElement("li");return e&&n.appendChild(e),t?s.__ul.insertBefore(n,t):s.__ul.appendChild(n),s.onResize(),n}function hn(s){p.unbind(window,"resize",s.__resizeHandler),s.saveToLocalStorageIfPossible&&p.unbind(window,"unload",s.saveToLocalStorageIfPossible)}function ct(s,e){var t=s.__preset_select[s.__preset_select.selectedIndex];e?t.innerHTML=t.value+"*":t.innerHTML=t.value}function di(s,e,t){if(t.__li=e,t.__gui=s,E.extend(t,{options:function(r){if(arguments.length>1){var a=t.__li.nextElementSibling;return t.remove(),Le(s,t.object,t.property,{before:a,factoryArgs:[E.toArray(arguments)]})}if(E.isArray(r)||E.isObject(r)){var c=t.__li.nextElementSibling;return t.remove(),Le(s,t.object,t.property,{before:c,factoryArgs:[r]})}},name:function(r){return t.__li.firstElementChild.firstElementChild.innerHTML=r,t},listen:function(){return t.__gui.listen(t),t},remove:function(){return t.__gui.remove(t),t}}),t instanceof it){var n=new je(t.object,t.property,{min:t.__min,max:t.__max,step:t.__step});E.each(["updateDisplay","onChange","onFinishChange","step","min","max"],function(o){var r=t[o],a=n[o];t[o]=n[o]=function(){var c=Array.prototype.slice.call(arguments);return a.apply(n,c),r.apply(t,c)}}),p.addClass(e,"has-slider"),t.domElement.insertBefore(n.domElement,t.domElement.firstElementChild)}else if(t instanceof je){var i=function(r){if(E.isNumber(t.__min)&&E.isNumber(t.__max)){var a=t.__li.firstElementChild.firstElementChild.innerHTML,c=t.__gui.__listening.indexOf(t)>-1;t.remove();var u=Le(s,t.object,t.property,{before:t.__li.nextElementSibling,factoryArgs:[t.__min,t.__max,t.__step]});return u.name(a),c&&u.listen(),u}return r};t.min=E.compose(i,t.min),t.max=E.compose(i,t.max)}else t instanceof tn?(p.bind(e,"click",function(){p.fakeEvent(t.__checkbox,"click")}),p.bind(t.__checkbox,"click",function(o){o.stopPropagation()})):t instanceof rn?(p.bind(e,"click",function(){p.fakeEvent(t.__button,"click")}),p.bind(e,"mouseover",function(){p.addClass(t.__button,"hover")}),p.bind(e,"mouseout",function(){p.removeClass(t.__button,"hover")})):t instanceof ot&&(p.addClass(e,"color"),t.updateDisplay=E.compose(function(o){return e.style.borderLeftColor=t.__color.toString(),o},t.updateDisplay),t.updateDisplay());t.setValue=E.compose(function(o){return s.getRoot().__preset_select&&t.isModified()&&ct(s.getRoot(),!0),o},t.setValue)}function pn(s,e){var t=s.getRoot(),n=t.__rememberedObjects.indexOf(e.object);if(n!==-1){var i=t.__rememberedObjectIndecesToControllers[n];if(i===void 0&&(i={},t.__rememberedObjectIndecesToControllers[n]=i),i[e.property]=e,t.load&&t.load.remembered){var o=t.load.remembered,r=void 0;if(o[s.preset])r=o[s.preset];else if(o[Ae])r=o[Ae];else return;if(r[n]&&r[n][e.property]!==void 0){var a=r[n][e.property];e.initialValue=a,e.setValue(a)}}}}function Le(s,e,t,n){if(e[t]===void 0)throw new Error('Object "'+e+'" has no property "'+t+'"');var i=void 0;if(n.color)i=new ot(e,t);else{var o=[e,t].concat(n.factoryArgs);i=ri.apply(s,o)}n.before instanceof le&&(n.before=n.before.__li),pn(s,i),p.addClass(i.domElement,"c");var r=document.createElement("span");p.addClass(r,"property-name"),r.innerHTML=i.property;var a=document.createElement("div");a.appendChild(r),a.appendChild(i.domElement);var c=at(s,a,n.before);return p.addClass(c,F.CLASS_CONTROLLER_ROW),i instanceof ot?p.addClass(c,"color"):p.addClass(c,qs(i.getValue())),di(s,c,i),s.__controllers.push(i),i}function ye(s,e){return document.location.href+"."+e}function lt(s,e,t){var n=document.createElement("option");n.innerHTML=e,n.value=e,s.__preset_select.appendChild(n),t&&(s.__preset_select.selectedIndex=s.__preset_select.length-1)}function mn(s,e){e.style.display=s.useLocalStorage?"block":"none"}function fi(s){var e=s.__save_row=document.createElement("li");p.addClass(s.domElement,"has-save"),s.__ul.insertBefore(e,s.__ul.firstChild),p.addClass(e,"save-row");var t=document.createElement("span");t.innerHTML="&nbsp;",p.addClass(t,"button gears");var n=document.createElement("span");n.innerHTML="Save",p.addClass(n,"button"),p.addClass(n,"save");var i=document.createElement("span");i.innerHTML="New",p.addClass(i,"button"),p.addClass(i,"save-as");var o=document.createElement("span");o.innerHTML="Revert",p.addClass(o,"button"),p.addClass(o,"revert");var r=s.__preset_select=document.createElement("select");if(s.load&&s.load.remembered?E.each(s.load.remembered,function(d,f){lt(s,f,f===s.preset)}):lt(s,Ae,!1),p.bind(r,"change",function(){for(var d=0;d<s.__preset_select.length;d++)s.__preset_select[d].innerHTML=s.__preset_select[d].value;s.preset=this.value}),e.appendChild(r),e.appendChild(t),e.appendChild(n),e.appendChild(i),e.appendChild(o),Se){var a=document.getElementById("dg-local-explain"),c=document.getElementById("dg-local-storage"),u=document.getElementById("dg-save-locally");u.style.display="block",localStorage.getItem(ye(s,"isLocal"))==="true"&&c.setAttribute("checked","checked"),mn(s,a),p.bind(c,"change",function(){s.useLocalStorage=!s.useLocalStorage,mn(s,a)})}var l=document.getElementById("dg-new-constructor");p.bind(l,"keydown",function(d){d.metaKey&&(d.which===67||d.keyCode===67)&&Re.hide()}),p.bind(t,"click",function(){l.innerHTML=JSON.stringify(s.getSaveObject(),void 0,2),Re.show(),l.focus(),l.select()}),p.bind(n,"click",function(){s.save()}),p.bind(i,"click",function(){var d=prompt("Enter a new preset name.");d&&s.saveAs(d)}),p.bind(o,"click",function(){s.revert()})}function hi(s){var e=void 0;s.__resize_handle=document.createElement("div"),E.extend(s.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"});function t(o){return o.preventDefault(),s.width+=e-o.clientX,s.onResize(),e=o.clientX,!1}function n(){p.removeClass(s.__closeButton,F.CLASS_DRAG),p.unbind(window,"mousemove",t),p.unbind(window,"mouseup",n)}function i(o){return o.preventDefault(),e=o.clientX,p.addClass(s.__closeButton,F.CLASS_DRAG),p.bind(window,"mousemove",t),p.bind(window,"mouseup",n),!1}p.bind(s.__resize_handle,"mousedown",i),p.bind(s.__closeButton,"mousedown",i),s.domElement.insertBefore(s.__resize_handle,s.domElement.firstElementChild)}function ut(s,e){s.domElement.style.width=e+"px",s.__save_row&&s.autoPlace&&(s.__save_row.style.width=e+"px"),s.__closeButton&&(s.__closeButton.style.width=e+"px")}function ze(s,e){var t={};return E.each(s.__rememberedObjects,function(n,i){var o={},r=s.__rememberedObjectIndecesToControllers[i];E.each(r,function(a,c){o[c]=e?a.initialValue:a.getValue()}),t[i]=o}),t}function pi(s){for(var e=0;e<s.__preset_select.length;e++)s.__preset_select[e].value===s.preset&&(s.__preset_select.selectedIndex=e)}function _n(s){s.length!==0&&ci.call(window,function(){_n(s)}),E.each(s,function(e){e.updateDisplay()})}var gn=F;const mi=["ACESFilmic","Linear","Reinhard","Cineon"],_i={0:"Linear",1:"Linear",2:"Reinhard",3:"Cineon",4:"ACESFilmic"},Ke=document.createElement("canvas"),gi=Ke.getContext("2d");function bi(s,e="jpeg"){let t=Ke.toDataURL(`image/${e}`);try{t.replace(`image/${e}`,"image/octet-stream");let n=document.createElement("a");n.style.display="none",document.body.appendChild(n),n.href=t,n.download=`${s}.${e}`,n.click()}catch(n){console.error(n),alert(n)}}function Io(){let s=!1,e=!1,t=document.getElementById("cameraInfo");t&&(t.style.display="none",t.dataBegin=!1);let n=null;function i(u){if(!!u)return t}function o(u){if(!u)return;const l=new Te;return l.setMode(0),l.domElement.style.position="absolute",l.domElement.style.left="10px",l.domElement.style.top="auto",l.domElement.style.bottom="30px",document.body.appendChild(l.domElement),n=l.domElement,n.style.display="none",l}function r(u,l){u.enableTemporal&&u.enableSpatial?l.setDemodulateAlbedo(!0):l.setDemodulateAlbedo(!1)}function a(){return new gn({closeOnTop:!0})}function c(u,l){if(!u)return;const d=new gn({closeOnTop:!0}),{colorBlendFactor:f,momentBlendFactor:m,colorFactor:y,normalFactor:_,positionFactor:g}=l.getDenoiseFactors(),v={bounces:l.bounces,envIntensity:l.envMapIntensity,enviromentVisible:l.enviromentVisible,toneMapping:_i[l.toneMapping],offFocusRender:l.renderWhenOffFocus,useTileRender:l.useTileRender,tileSlicesNum:l.tileSlicesNum||0,movingDownsampling:l.movingDownsampling,enableDenoise:!!l.enableDenoise,enableTemporal:!!l.enableTemporalDenoise,colorBlend:f,momentBlend:m,enableSpatial:!!l.enableSpatialDenoise,colorFactor:y,normalFactor:_,positionFactor:g,demodulateAlbedo:!1,sampleCount:s,stats:e,saveScreenShot:()=>{const b=l.size.x,S=l.size.y;Ke.width=b,Ke.height=S;let L=!1;l.fullSampleCallback=()=>{L||(gi.drawImage(l.domElement,0,0),bi("LGLTracer","png"),L=!0)}},deleteAllGUI:()=>{d.domElement.parentElement.remove(d.domElement)},dispose:()=>{l.dispose()},updateTransform:()=>{l.updateMeshTransform()},updateMaterial:()=>{l.updateMeshMaterial()}},w=d.addFolder("Setting");w.add(v,"bounces",2,8).step(1).onFinishChange(b=>{l.bounces=b,l.needsUpdate=!0}),w.add(v,"envIntensity",0,5).step(.5).onFinishChange(b=>{l.envMapIntensity=b,l.needsUpdate=!0}),w.add(v,"toneMapping",mi).onChange(b=>{const S=is[`${b}ToneMapping`];l.toneMapping=S}),w.add(v,"offFocusRender").onChange(b=>{l.renderWhenOffFocus=b}),w.add(v,"useTileRender").onChange(b=>{b&&(v.movingDownsampling=!0,w.updateDisplay(),l.movingDownsampling=b),l.useTileRender=b,l.needsUpdate=!0}),w.add(v,"tileSlicesNum",0,32,1).onFinishChange(b=>{t.style.display==="none"&&(t.dataBegin=!0,t.style.display="block"),v.useTileRender||(v.useTileRender=!0,l.useTileRender=!0,v.movingDownsampling||(v.movingDownsampling=!0,l.movingDownsampling=b),w.updateDisplay()),l.tileSlicesNum=b,l.setTileSlicesNumber(b),v.sampleCount=!0,T.updateDisplay(),l.needsUpdate=!0}),w.add(v,"movingDownsampling").onChange(b=>{l.movingDownsampling=b});const T=d.addFolder("Debug UI");T.add(v,"sampleCount").onChange(b=>{!t||(b?(t.dataBegin=!0,t.style.display="block"):(t.dataBegin=!1,t.style.display="none"))}),T.add(v,"stats").onChange(b=>{!n||(b?n.style.display="block":n.style.display="none")}),T.add(v,"saveScreenShot"),T.add(v,"deleteAllGUI");const x=d.addFolder("Denoise(SVGF)");return x.add(v,"enableDenoise").name("enable").onChange(b=>{l.enableDenoise=b}),x.add(v,"enableTemporal").onChange(b=>{r(v,l),l.enableTemporalDenoise=b,l.needsUpdate=!0}),x.add(v,"colorBlend",0,1).step(.001).onFinishChange(b=>{l.setDenoiseColorBlendFactor(b)}),x.add(v,"momentBlend",0,1).step(.001).onFinishChange(b=>{l.setDenoiseMomentBlendFactor(b)}),x.add(v,"enableSpatial").onChange(b=>{r(v,l),l.enableSpatialDenoise=b,l.needsUpdate=!0}),x.add(v,"colorFactor",0,5).step(.001).onFinishChange(b=>{l.setDenoiseColorFactor(b)}),x.add(v,"normalFactor",0,1).step(.01).onFinishChange(b=>{l.setDenoiseNormalFactor(b)}),x.add(v,"positionFactor",0,.5).step(.001).onFinishChange(b=>{l.setDenoisePositionFactor(b)}),w.open(),{gui:d,params:v,settingFolder:w,denoiseFolder:x}}return{initStats:o,initGUI:c,initCameraDebugInfo:i,initNewGUI:a}}class dt extends Gt{constructor(e){super(e);this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new Ti(t)}),this.register(function(t){return new Li(t)}),this.register(function(t){return new Mi(t)}),this.register(function(t){return new wi(t)}),this.register(function(t){return new xi(t)}),this.register(function(t){return new Ai(t)}),this.register(function(t){return new Si(t)}),this.register(function(t){return new Ri(t)}),this.register(function(t){return new Ei(t)}),this.register(function(t){return new Ci(t)})}load(e,t,n,i){const o=this;let r;this.resourcePath!==""?r=this.resourcePath:this.path!==""?r=this.path:r=te.extractUrlBase(e),this.manager.itemStart(e);const a=function(u){i?i(u):console.error(u),o.manager.itemError(e),o.manager.itemEnd(e)},c=new Ie(this.manager);c.setPath(this.path),c.setResponseType("arraybuffer"),c.setRequestHeader(this.requestHeader),c.setWithCredentials(this.withCredentials),c.load(e,function(u){try{o.parse(u,r,function(l){t(l),o.manager.itemEnd(e)},a)}catch(l){a(l)}},n,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,i){let o;const r={},a={};if(typeof e=="string")o=e;else if(te.decodeText(new Uint8Array(e,0,4))===bn){try{r[O.KHR_BINARY_GLTF]=new Oi(e)}catch(d){i&&i(d);return}o=r[O.KHR_BINARY_GLTF].content}else o=te.decodeText(new Uint8Array(e));const c=JSON.parse(o);if(c.asset===void 0||c.asset.version[0]<2){i&&i(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const u=new zi(c,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});u.fileLoader.setRequestHeader(this.requestHeader);for(let l=0;l<this.pluginCallbacks.length;l++){const d=this.pluginCallbacks[l](u);a[d.name]=d,r[d.name]=!0}if(c.extensionsUsed)for(let l=0;l<c.extensionsUsed.length;++l){const d=c.extensionsUsed[l],f=c.extensionsRequired||[];switch(d){case O.KHR_MATERIALS_UNLIT:r[d]=new vi;break;case O.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:r[d]=new Di;break;case O.KHR_DRACO_MESH_COMPRESSION:r[d]=new ki(c,this.dracoLoader);break;case O.KHR_TEXTURE_TRANSFORM:r[d]=new Pi;break;case O.KHR_MESH_QUANTIZATION:r[d]=new Fi;break;default:f.indexOf(d)>=0&&a[d]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+d+'".')}}u.setExtensions(r),u.setPlugins(a),u.parse(n,i)}parseAsync(e,t){const n=this;return new Promise(function(i,o){n.parse(e,t,i,o)})}}function yi(){let s={};return{get:function(e){return s[e]},add:function(e,t){s[e]=t},remove:function(e){delete s[e]},removeAll:function(){s={}}}}const O={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"};class Ei{constructor(e){this.parser=e,this.name=O.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let n=0,i=t.length;n<i;n++){const o=t[n];o.extensions&&o.extensions[this.name]&&o.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,o.extensions[this.name].light)}}_loadLight(e){const t=this.parser,n="light:"+e;let i=t.cache.get(n);if(i)return i;const o=t.json,c=((o.extensions&&o.extensions[this.name]||{}).lights||[])[e];let u;const l=new G(16777215);c.color!==void 0&&l.fromArray(c.color);const d=c.range!==void 0?c.range:0;switch(c.type){case"directional":u=new as(l),u.target.position.set(0,0,-1),u.add(u.target);break;case"point":u=new rs(l),u.distance=d;break;case"spot":u=new os(l),u.distance=d,c.spot=c.spot||{},c.spot.innerConeAngle=c.spot.innerConeAngle!==void 0?c.spot.innerConeAngle:0,c.spot.outerConeAngle=c.spot.outerConeAngle!==void 0?c.spot.outerConeAngle:Math.PI/4,u.angle=c.spot.outerConeAngle,u.penumbra=1-c.spot.innerConeAngle/c.spot.outerConeAngle,u.target.position.set(0,0,-1),u.add(u.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+c.type)}return u.position.set(0,0,0),u.decay=2,c.intensity!==void 0&&(u.intensity=c.intensity),u.name=t.createUniqueName(c.name||"light_"+e),i=Promise.resolve(u),t.cache.add(n,i),i}createNodeAttachment(e){const t=this,n=this.parser,o=n.json.nodes[e],a=(o.extensions&&o.extensions[this.name]||{}).light;return a===void 0?null:this._loadLight(a).then(function(c){return n._getNodeRef(t.cache,a,c)})}}class vi{constructor(){this.name=O.KHR_MATERIALS_UNLIT}getMaterialType(){return Ee}extendParams(e,t,n){const i=[];e.color=new G(1,1,1),e.opacity=1;const o=t.pbrMetallicRoughness;if(o){if(Array.isArray(o.baseColorFactor)){const r=o.baseColorFactor;e.color.fromArray(r),e.opacity=r[3]}o.baseColorTexture!==void 0&&i.push(n.assignTexture(e,"map",o.baseColorTexture,ce))}return Promise.all(i)}}class Ti{constructor(e){this.parser=e,this.name=O.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:_e}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const o=[],r=i.extensions[this.name];if(r.clearcoatFactor!==void 0&&(t.clearcoat=r.clearcoatFactor),r.clearcoatTexture!==void 0&&o.push(n.assignTexture(t,"clearcoatMap",r.clearcoatTexture)),r.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=r.clearcoatRoughnessFactor),r.clearcoatRoughnessTexture!==void 0&&o.push(n.assignTexture(t,"clearcoatRoughnessMap",r.clearcoatRoughnessTexture)),r.clearcoatNormalTexture!==void 0&&(o.push(n.assignTexture(t,"clearcoatNormalMap",r.clearcoatNormalTexture)),r.clearcoatNormalTexture.scale!==void 0)){const a=r.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new X(a,a)}return Promise.all(o)}}class wi{constructor(e){this.parser=e,this.name=O.KHR_MATERIALS_SHEEN}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:_e}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const o=[];t.sheenColor=new G(0,0,0),t.sheenRoughness=0,t.sheen=1;const r=i.extensions[this.name];return r.sheenColorFactor!==void 0&&t.sheenColor.fromArray(r.sheenColorFactor),r.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=r.sheenRoughnessFactor),r.sheenColorTexture!==void 0&&o.push(n.assignTexture(t,"sheenColorMap",r.sheenColorTexture,ce)),r.sheenRoughnessTexture!==void 0&&o.push(n.assignTexture(t,"sheenRoughnessMap",r.sheenRoughnessTexture)),Promise.all(o)}}class xi{constructor(e){this.parser=e,this.name=O.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:_e}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const o=[],r=i.extensions[this.name];return r.transmissionFactor!==void 0&&(t.transmission=r.transmissionFactor),r.transmissionTexture!==void 0&&o.push(n.assignTexture(t,"transmissionMap",r.transmissionTexture)),Promise.all(o)}}class Ai{constructor(e){this.parser=e,this.name=O.KHR_MATERIALS_VOLUME}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:_e}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const o=[],r=i.extensions[this.name];t.thickness=r.thicknessFactor!==void 0?r.thicknessFactor:0,r.thicknessTexture!==void 0&&o.push(n.assignTexture(t,"thicknessMap",r.thicknessTexture)),t.attenuationDistance=r.attenuationDistance||0;const a=r.attenuationColor||[1,1,1];return t.attenuationColor=new G(a[0],a[1],a[2]),Promise.all(o)}}class Si{constructor(e){this.parser=e,this.name=O.KHR_MATERIALS_IOR}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:_e}extendMaterialParams(e,t){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const o=i.extensions[this.name];return t.ior=o.ior!==void 0?o.ior:1.5,Promise.resolve()}}class Ri{constructor(e){this.parser=e,this.name=O.KHR_MATERIALS_SPECULAR}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:_e}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const o=[],r=i.extensions[this.name];t.specularIntensity=r.specularFactor!==void 0?r.specularFactor:1,r.specularTexture!==void 0&&o.push(n.assignTexture(t,"specularIntensityMap",r.specularTexture));const a=r.specularColorFactor||[1,1,1];return t.specularColor=new G(a[0],a[1],a[2]),r.specularColorTexture!==void 0&&o.push(n.assignTexture(t,"specularColorMap",r.specularColorTexture,ce)),Promise.all(o)}}class Li{constructor(e){this.parser=e,this.name=O.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,n=t.json,i=n.textures[e];if(!i.extensions||!i.extensions[this.name])return null;const o=i.extensions[this.name],r=t.options.ktx2Loader;if(!r){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,o.source,r)}}class Mi{constructor(e){this.parser=e,this.name=O.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,i=n.json,o=i.textures[e];if(!o.extensions||!o.extensions[t])return null;const r=o.extensions[t],a=i.images[r.source];let c=n.textureLoader;if(a.uri){const u=n.options.manager.getHandler(a.uri);u!==null&&(c=u)}return this.detectSupport().then(function(u){if(u)return n.loadTextureImage(e,a,c);if(i.extensionsRequired&&i.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class Ci{constructor(e){this.name=O.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){const i=n.extensions[this.name],o=this.parser.getDependency("buffer",i.buffer),r=this.parser.options.meshoptDecoder;if(!r||!r.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Promise.all([o,r.ready]).then(function(a){const c=i.byteOffset||0,u=i.byteLength||0,l=i.count,d=i.byteStride,f=new ArrayBuffer(l*d),m=new Uint8Array(a[0],c,u);return r.decodeGltfBuffer(new Uint8Array(f),l,d,m,i.mode,i.filter),f})}else return null}}const bn="glTF",Me=12,yn={JSON:1313821514,BIN:5130562};class Oi{constructor(e){this.name=O.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,Me);if(this.header={magic:te.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==bn)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const n=this.header.length-Me,i=new DataView(e,Me);let o=0;for(;o<n;){const r=i.getUint32(o,!0);o+=4;const a=i.getUint32(o,!0);if(o+=4,a===yn.JSON){const c=new Uint8Array(e,Me+o,r);this.content=te.decodeText(c)}else if(a===yn.BIN){const c=Me+o;this.body=e.slice(c,c+r)}o+=r}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class ki{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=O.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const n=this.json,i=this.dracoLoader,o=e.extensions[this.name].bufferView,r=e.extensions[this.name].attributes,a={},c={},u={};for(const l in r){const d=ht[l]||l.toLowerCase();a[d]=r[l]}for(const l in e.attributes){const d=ht[l]||l.toLowerCase();if(r[l]!==void 0){const f=n.accessors[e.attributes[l]],m=Ce[f.componentType];u[d]=m,c[d]=f.normalized===!0}}return t.getDependency("bufferView",o).then(function(l){return new Promise(function(d){i.decodeDracoFile(l,function(f){for(const m in f.attributes){const y=f.attributes[m],_=c[m];_!==void 0&&(y.normalized=_)}d(f)},a,u)})})}}class Pi{constructor(){this.name=O.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return t.texCoord!==void 0&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class ft extends Qe{constructor(e){super();this.isGLTFSpecularGlossinessMaterial=!0;const t=["#ifdef USE_SPECULARMAP","	uniform sampler2D specularMap;","#endif"].join(`
`),n=["#ifdef USE_GLOSSINESSMAP","	uniform sampler2D glossinessMap;","#endif"].join(`
`),i=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","	vec4 texelSpecular = texture2D( specularMap, vUv );","	// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","	specularFactor *= texelSpecular.rgb;","#endif"].join(`
`),o=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","	vec4 texelGlossiness = texture2D( glossinessMap, vUv );","	// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","	glossinessFactor *= texelGlossiness.a;","#endif"].join(`
`),r=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.roughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.specularColor = specularFactor;"].join(`
`),a={specular:{value:new G().setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=a,this.onBeforeCompile=function(c){for(const u in a)c.uniforms[u]=a[u];c.fragmentShader=c.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",t).replace("#include <metalnessmap_pars_fragment>",n).replace("#include <roughnessmap_fragment>",i).replace("#include <metalnessmap_fragment>",o).replace("#include <lights_physical_fragment>",r)},Object.defineProperties(this,{specular:{get:function(){return a.specular.value},set:function(c){a.specular.value=c}},specularMap:{get:function(){return a.specularMap.value},set:function(c){a.specularMap.value=c,c?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return a.glossiness.value},set:function(c){a.glossiness.value=c}},glossinessMap:{get:function(){return a.glossinessMap.value},set:function(c){a.glossinessMap.value=c,c?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(e)}copy(e){return super.copy(e),this.specularMap=e.specularMap,this.specular.copy(e.specular),this.glossinessMap=e.glossinessMap,this.glossiness=e.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this}}class Di{constructor(){this.name=O.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,this.specularGlossinessParams=["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"]}getMaterialType(){return ft}extendParams(e,t,n){const i=t.extensions[this.name];e.color=new G(1,1,1),e.opacity=1;const o=[];if(Array.isArray(i.diffuseFactor)){const r=i.diffuseFactor;e.color.fromArray(r),e.opacity=r[3]}if(i.diffuseTexture!==void 0&&o.push(n.assignTexture(e,"map",i.diffuseTexture,ce)),e.emissive=new G(0,0,0),e.glossiness=i.glossinessFactor!==void 0?i.glossinessFactor:1,e.specular=new G(1,1,1),Array.isArray(i.specularFactor)&&e.specular.fromArray(i.specularFactor),i.specularGlossinessTexture!==void 0){const r=i.specularGlossinessTexture;o.push(n.assignTexture(e,"glossinessMap",r)),o.push(n.assignTexture(e,"specularMap",r,ce))}return Promise.all(o)}createMaterial(e){const t=new ft(e);return t.fog=!0,t.color=e.color,t.map=e.map===void 0?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=e.aoMap===void 0?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=e.emissiveMap===void 0?null:e.emissiveMap,t.bumpMap=e.bumpMap===void 0?null:e.bumpMap,t.bumpScale=1,t.normalMap=e.normalMap===void 0?null:e.normalMap,t.normalMapType=cs,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=e.specularMap===void 0?null:e.specularMap,t.specular=e.specular,t.glossinessMap=e.glossinessMap===void 0?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=e.envMap===void 0?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t}}class Fi{constructor(){this.name=O.KHR_MESH_QUANTIZATION}}class ue extends ls{constructor(e,t,n,i){super(e,t,n,i)}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,i=this.valueSize,o=e*i*3+i;for(let r=0;r!==i;r++)t[r]=n[o+r];return t}}ue.prototype.beforeStart_=ue.prototype.copySampleValue_;ue.prototype.afterEnd_=ue.prototype.copySampleValue_;ue.prototype.interpolate_=function(s,e,t,n){const i=this.resultBuffer,o=this.sampleValues,r=this.valueSize,a=r*2,c=r*3,u=n-e,l=(t-e)/u,d=l*l,f=d*l,m=s*c,y=m-c,_=-2*f+3*d,g=f-d,v=1-_,w=g-d+l;for(let T=0;T!==r;T++){const x=o[y+T+r],b=o[y+T+a]*u,S=o[m+T+r],L=o[m+T]*u;i[T]=v*x+w*b+_*S+g*L}return i};const Ni=new qe;class Ii extends ue{interpolate_(e,t,n,i){const o=super.interpolate_(e,t,n,i);return Ni.fromArray(o).normalize().toArray(o),o}}const ne={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},Ce={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},En={9728:us,9729:me,9984:ds,9985:fs,9986:hs,9987:Vt},vn={33071:jt,33648:zt,10497:Be},Tn={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},ht={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},re={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Bi={CUBICSPLINE:void 0,LINEAR:Kt,STEP:ps},pt={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function Ui(s){return s.DefaultMaterial===void 0&&(s.DefaultMaterial=new Qe({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Us})),s.DefaultMaterial}function Oe(s,e,t){for(const n in t.extensions)s[n]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[n]=t.extensions[n])}function de(s,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(s.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function Hi(s,e,t){let n=!1,i=!1,o=!1;for(let u=0,l=e.length;u<l;u++){const d=e[u];if(d.POSITION!==void 0&&(n=!0),d.NORMAL!==void 0&&(i=!0),d.COLOR_0!==void 0&&(o=!0),n&&i&&o)break}if(!n&&!i&&!o)return Promise.resolve(s);const r=[],a=[],c=[];for(let u=0,l=e.length;u<l;u++){const d=e[u];if(n){const f=d.POSITION!==void 0?t.getDependency("accessor",d.POSITION):s.attributes.position;r.push(f)}if(i){const f=d.NORMAL!==void 0?t.getDependency("accessor",d.NORMAL):s.attributes.normal;a.push(f)}if(o){const f=d.COLOR_0!==void 0?t.getDependency("accessor",d.COLOR_0):s.attributes.color;c.push(f)}}return Promise.all([Promise.all(r),Promise.all(a),Promise.all(c)]).then(function(u){const l=u[0],d=u[1],f=u[2];return n&&(s.morphAttributes.position=l),i&&(s.morphAttributes.normal=d),o&&(s.morphAttributes.color=f),s.morphTargetsRelative=!0,s})}function Gi(s,e){if(s.updateMorphTargets(),e.weights!==void 0)for(let t=0,n=e.weights.length;t<n;t++)s.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(s.morphTargetInfluences.length===t.length){s.morphTargetDictionary={};for(let n=0,i=t.length;n<i;n++)s.morphTargetDictionary[t[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function Vi(s){const e=s.extensions&&s.extensions[O.KHR_DRACO_MESH_COMPRESSION];let t;return e?t="draco:"+e.bufferView+":"+e.indices+":"+wn(e.attributes):t=s.indices+":"+wn(s.attributes)+":"+s.mode,t}function wn(s){let e="";const t=Object.keys(s).sort();for(let n=0,i=t.length;n<i;n++)e+=t[n]+":"+s[t[n]]+";";return e}function mt(s){switch(s){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function ji(s){return s.search(/\.jpe?g($|\?)/i)>0||s.search(/^data\:image\/jpeg/)===0?"image/jpeg":s.search(/\.webp($|\?)/i)>0||s.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}class zi{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new yi,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={},typeof createImageBitmap!="undefined"&&/Firefox|^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!1?this.textureLoader=new ms(this.options.manager):this.textureLoader=new _s(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Ie(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const n=this,i=this.json,o=this.extensions;this.cache.removeAll(),this._invokeAll(function(r){return r._markDefs&&r._markDefs()}),Promise.all(this._invokeAll(function(r){return r.beforeRoot&&r.beforeRoot()})).then(function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])}).then(function(r){const a={scene:r[0][i.scene||0],scenes:r[0],animations:r[1],cameras:r[2],asset:i.asset,parser:n,userData:{}};Oe(o,a,i),de(a,i),Promise.all(n._invokeAll(function(c){return c.afterRoot&&c.afterRoot(a)})).then(function(){e(a)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[];for(let i=0,o=t.length;i<o;i++){const r=t[i].joints;for(let a=0,c=r.length;a<c;a++)e[r[a]].isBone=!0}for(let i=0,o=e.length;i<o;i++){const r=e[i];r.mesh!==void 0&&(this._addNodeRef(this.meshCache,r.mesh),r.skin!==void 0&&(n[r.mesh].isSkinnedMesh=!0)),r.camera!==void 0&&this._addNodeRef(this.cameraCache,r.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,n){if(e.refs[t]<=1)return n;const i=n.clone(),o=(r,a)=>{const c=this.associations.get(r);c!=null&&this.associations.set(a,c);for(const[u,l]of r.children.entries())o(l,a.children[u])};return o(n,i),i.name+="_instance_"+e.uses[t]++,i}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let n=0;n<t.length;n++){const i=e(t[n]);if(i)return i}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const n=[];for(let i=0;i<t.length;i++){const o=e(t[i]);o&&n.push(o)}return n}getDependency(e,t){const n=e+":"+t;let i=this.cache.get(n);if(!i){switch(e){case"scene":i=this.loadScene(t);break;case"node":i=this.loadNode(t);break;case"mesh":i=this._invokeOne(function(o){return o.loadMesh&&o.loadMesh(t)});break;case"accessor":i=this.loadAccessor(t);break;case"bufferView":i=this._invokeOne(function(o){return o.loadBufferView&&o.loadBufferView(t)});break;case"buffer":i=this.loadBuffer(t);break;case"material":i=this._invokeOne(function(o){return o.loadMaterial&&o.loadMaterial(t)});break;case"texture":i=this._invokeOne(function(o){return o.loadTexture&&o.loadTexture(t)});break;case"skin":i=this.loadSkin(t);break;case"animation":i=this.loadAnimation(t);break;case"camera":i=this.loadCamera(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(n,i)}return i}getDependencies(e){let t=this.cache.get(e);if(!t){const n=this,i=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(i.map(function(o,r){return n.getDependency(e,r)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],n=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[O.KHR_BINARY_GLTF].body);const i=this.options;return new Promise(function(o,r){n.load(te.resolveURL(t.uri,i.path),o,void 0,function(){r(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(n){const i=t.byteLength||0,o=t.byteOffset||0;return n.slice(o,o+i)})}loadAccessor(e){const t=this,n=this.json,i=this.json.accessors[e];if(i.bufferView===void 0&&i.sparse===void 0)return Promise.resolve(null);const o=[];return i.bufferView!==void 0?o.push(this.getDependency("bufferView",i.bufferView)):o.push(null),i.sparse!==void 0&&(o.push(this.getDependency("bufferView",i.sparse.indices.bufferView)),o.push(this.getDependency("bufferView",i.sparse.values.bufferView))),Promise.all(o).then(function(r){const a=r[0],c=Tn[i.type],u=Ce[i.componentType],l=u.BYTES_PER_ELEMENT,d=l*c,f=i.byteOffset||0,m=i.bufferView!==void 0?n.bufferViews[i.bufferView].byteStride:void 0,y=i.normalized===!0;let _,g;if(m&&m!==d){const v=Math.floor(f/m),w="InterleavedBuffer:"+i.bufferView+":"+i.componentType+":"+v+":"+i.count;let T=t.cache.get(w);T||(_=new u(a,v*m,i.count*m/l),T=new gs(_,m/l),t.cache.add(w,T)),g=new bs(T,c,f%m/l,y)}else a===null?_=new u(i.count*c):_=new u(a,f,i.count*c),g=new Ue(_,c,y);if(i.sparse!==void 0){const v=Tn.SCALAR,w=Ce[i.sparse.indices.componentType],T=i.sparse.indices.byteOffset||0,x=i.sparse.values.byteOffset||0,b=new w(r[1],T,i.sparse.count*v),S=new u(r[2],x,i.sparse.count*c);a!==null&&(g=new Ue(g.array.slice(),g.itemSize,g.normalized));for(let L=0,C=b.length;L<C;L++){const A=b[L];if(g.setX(A,S[L*c]),c>=2&&g.setY(A,S[L*c+1]),c>=3&&g.setZ(A,S[L*c+2]),c>=4&&g.setW(A,S[L*c+3]),c>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return g})}loadTexture(e){const t=this.json,n=this.options,o=t.textures[e].source,r=t.images[o];let a=this.textureLoader;if(r.uri){const c=n.manager.getHandler(r.uri);c!==null&&(a=c)}return this.loadTextureImage(e,o,a)}loadTextureImage(e,t,n){const i=this,o=this.json,r=o.textures[e],a=o.images[t],c=(a.uri||a.bufferView)+":"+r.sampler;if(this.textureCache[c])return this.textureCache[c];const u=this.loadImageSource(t,n).then(function(l){l.flipY=!1,r.name&&(l.name=r.name);const f=(o.samplers||{})[r.sampler]||{};return l.magFilter=En[f.magFilter]||me,l.minFilter=En[f.minFilter]||Vt,l.wrapS=vn[f.wrapS]||Be,l.wrapT=vn[f.wrapT]||Be,i.associations.set(l,{textures:e}),l}).catch(function(){return null});return this.textureCache[c]=u,u}loadImageSource(e,t){const n=this,i=this.json,o=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(d=>d.clone());const r=i.images[e],a=self.URL||self.webkitURL;let c=r.uri||"",u=!1;if(r.bufferView!==void 0)c=n.getDependency("bufferView",r.bufferView).then(function(d){u=!0;const f=new Blob([d],{type:r.mimeType});return c=a.createObjectURL(f),c});else if(r.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const l=Promise.resolve(c).then(function(d){return new Promise(function(f,m){let y=f;t.isImageBitmapLoader===!0&&(y=function(_){const g=new qt(_);g.needsUpdate=!0,f(g)}),t.load(te.resolveURL(d,o.path),y,void 0,m)})}).then(function(d){return u===!0&&a.revokeObjectURL(c),d.userData.mimeType=r.mimeType||ji(r.uri),d}).catch(function(d){throw console.error("THREE.GLTFLoader: Couldn't load texture",c),d});return this.sourceCache[e]=l,l}assignTexture(e,t,n,i){const o=this;return this.getDependency("texture",n.index).then(function(r){if(n.texCoord!==void 0&&n.texCoord!=0&&!(t==="aoMap"&&n.texCoord==1)&&console.warn("THREE.GLTFLoader: Custom UV set "+n.texCoord+" for texture "+t+" not yet supported."),o.extensions[O.KHR_TEXTURE_TRANSFORM]){const a=n.extensions!==void 0?n.extensions[O.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const c=o.associations.get(r);r=o.extensions[O.KHR_TEXTURE_TRANSFORM].extendTexture(r,a),o.associations.set(r,c)}}return i!==void 0&&(r.encoding=i),e[t]=r,r})}assignFinalMaterial(e){const t=e.geometry;let n=e.material;const i=t.attributes.tangent===void 0,o=t.attributes.color!==void 0,r=t.attributes.normal===void 0;if(e.isPoints){const a="PointsMaterial:"+n.uuid;let c=this.cache.get(a);c||(c=new ys,He.prototype.copy.call(c,n),c.color.copy(n.color),c.map=n.map,c.sizeAttenuation=!1,this.cache.add(a,c)),n=c}else if(e.isLine){const a="LineBasicMaterial:"+n.uuid;let c=this.cache.get(a);c||(c=new Es,He.prototype.copy.call(c,n),c.color.copy(n.color),this.cache.add(a,c)),n=c}if(i||o||r){let a="ClonedMaterial:"+n.uuid+":";n.isGLTFSpecularGlossinessMaterial&&(a+="specular-glossiness:"),i&&(a+="derivative-tangents:"),o&&(a+="vertex-colors:"),r&&(a+="flat-shading:");let c=this.cache.get(a);c||(c=n.clone(),o&&(c.vertexColors=!0),r&&(c.flatShading=!0),i&&(c.normalScale&&(c.normalScale.y*=-1),c.clearcoatNormalScale&&(c.clearcoatNormalScale.y*=-1)),this.cache.add(a,c),this.associations.set(c,this.associations.get(n))),n=c}n.aoMap&&t.attributes.uv2===void 0&&t.attributes.uv!==void 0&&t.setAttribute("uv2",t.attributes.uv),e.material=n}getMaterialType(){return Qe}loadMaterial(e){const t=this,n=this.json,i=this.extensions,o=n.materials[e];let r;const a={},c=o.extensions||{},u=[];if(c[O.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){const d=i[O.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];r=d.getMaterialType(),u.push(d.extendParams(a,o,t))}else if(c[O.KHR_MATERIALS_UNLIT]){const d=i[O.KHR_MATERIALS_UNLIT];r=d.getMaterialType(),u.push(d.extendParams(a,o,t))}else{const d=o.pbrMetallicRoughness||{};if(a.color=new G(1,1,1),a.opacity=1,Array.isArray(d.baseColorFactor)){const f=d.baseColorFactor;a.color.fromArray(f),a.opacity=f[3]}d.baseColorTexture!==void 0&&u.push(t.assignTexture(a,"map",d.baseColorTexture,ce)),a.metalness=d.metallicFactor!==void 0?d.metallicFactor:1,a.roughness=d.roughnessFactor!==void 0?d.roughnessFactor:1,d.metallicRoughnessTexture!==void 0&&(u.push(t.assignTexture(a,"metalnessMap",d.metallicRoughnessTexture)),u.push(t.assignTexture(a,"roughnessMap",d.metallicRoughnessTexture))),r=this._invokeOne(function(f){return f.getMaterialType&&f.getMaterialType(e)}),u.push(Promise.all(this._invokeAll(function(f){return f.extendMaterialParams&&f.extendMaterialParams(e,a)})))}o.doubleSided===!0&&(a.side=vs);const l=o.alphaMode||pt.OPAQUE;if(l===pt.BLEND?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,l===pt.MASK&&(a.alphaTest=o.alphaCutoff!==void 0?o.alphaCutoff:.5)),o.normalTexture!==void 0&&r!==Ee&&(u.push(t.assignTexture(a,"normalMap",o.normalTexture)),a.normalScale=new X(1,1),o.normalTexture.scale!==void 0)){const d=o.normalTexture.scale;a.normalScale.set(d,d)}return o.occlusionTexture!==void 0&&r!==Ee&&(u.push(t.assignTexture(a,"aoMap",o.occlusionTexture)),o.occlusionTexture.strength!==void 0&&(a.aoMapIntensity=o.occlusionTexture.strength)),o.emissiveFactor!==void 0&&r!==Ee&&(a.emissive=new G().fromArray(o.emissiveFactor)),o.emissiveTexture!==void 0&&r!==Ee&&u.push(t.assignTexture(a,"emissiveMap",o.emissiveTexture,ce)),Promise.all(u).then(function(){let d;return r===ft?d=i[O.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(a):d=new r(a),o.name&&(d.name=o.name),de(d,o),t.associations.set(d,{materials:e}),o.extensions&&Oe(i,d,o),d})}createUniqueName(e){const t=Ts.sanitizeNodeName(e||"");let n=t;for(let i=1;this.nodeNamesUsed[n];++i)n=t+"_"+i;return this.nodeNamesUsed[n]=!0,n}loadGeometries(e){const t=this,n=this.extensions,i=this.primitiveCache;function o(a){return n[O.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,t).then(function(c){return An(c,a,t)})}const r=[];for(let a=0,c=e.length;a<c;a++){const u=e[a],l=Vi(u),d=i[l];if(d)r.push(d.promise);else{let f;u.extensions&&u.extensions[O.KHR_DRACO_MESH_COMPRESSION]?f=o(u):f=An(new Xt,u,t),i[l]={primitive:u,promise:f},r.push(f)}}return Promise.all(r)}loadMesh(e){const t=this,n=this.json,i=this.extensions,o=n.meshes[e],r=o.primitives,a=[];for(let c=0,u=r.length;c<u;c++){const l=r[c].material===void 0?Ui(this.cache):this.getDependency("material",r[c].material);a.push(l)}return a.push(t.loadGeometries(r)),Promise.all(a).then(function(c){const u=c.slice(0,c.length-1),l=c[c.length-1],d=[];for(let m=0,y=l.length;m<y;m++){const _=l[m],g=r[m];let v;const w=u[m];if(g.mode===ne.TRIANGLES||g.mode===ne.TRIANGLE_STRIP||g.mode===ne.TRIANGLE_FAN||g.mode===void 0)v=o.isSkinnedMesh===!0?new ws(_,w):new xs(_,w),v.isSkinnedMesh===!0&&!v.geometry.attributes.skinWeight.normalized&&v.normalizeSkinWeights(),g.mode===ne.TRIANGLE_STRIP?v.geometry=Sn(v.geometry,As):g.mode===ne.TRIANGLE_FAN&&(v.geometry=Sn(v.geometry,Yt));else if(g.mode===ne.LINES)v=new Ss(_,w);else if(g.mode===ne.LINE_STRIP)v=new Rs(_,w);else if(g.mode===ne.LINE_LOOP)v=new Ls(_,w);else if(g.mode===ne.POINTS)v=new Ms(_,w);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+g.mode);Object.keys(v.geometry.morphAttributes).length>0&&Gi(v,o),v.name=t.createUniqueName(o.name||"mesh_"+e),de(v,o),g.extensions&&Oe(i,v,g),t.assignFinalMaterial(v),d.push(v)}for(let m=0,y=d.length;m<y;m++)t.associations.set(d[m],{meshes:e,primitives:m});if(d.length===1)return d[0];const f=new Je;t.associations.set(f,{meshes:e});for(let m=0,y=d.length;m<y;m++)f.add(d[m]);return f})}loadCamera(e){let t;const n=this.json.cameras[e],i=n[n.type];if(!i){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return n.type==="perspective"?t=new Cs(Os.radToDeg(i.yfov),i.aspectRatio||1,i.znear||1,i.zfar||2e6):n.type==="orthographic"&&(t=new ks(-i.xmag,i.xmag,i.ymag,-i.ymag,i.znear,i.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),de(t,n),Promise.resolve(t)}loadSkin(e){const t=this.json.skins[e],n={joints:t.joints};return t.inverseBindMatrices===void 0?Promise.resolve(n):this.getDependency("accessor",t.inverseBindMatrices).then(function(i){return n.inverseBindMatrices=i,n})}loadAnimation(e){const n=this.json.animations[e],i=[],o=[],r=[],a=[],c=[];for(let u=0,l=n.channels.length;u<l;u++){const d=n.channels[u],f=n.samplers[d.sampler],m=d.target,y=m.node!==void 0?m.node:m.id,_=n.parameters!==void 0?n.parameters[f.input]:f.input,g=n.parameters!==void 0?n.parameters[f.output]:f.output;i.push(this.getDependency("node",y)),o.push(this.getDependency("accessor",_)),r.push(this.getDependency("accessor",g)),a.push(f),c.push(m)}return Promise.all([Promise.all(i),Promise.all(o),Promise.all(r),Promise.all(a),Promise.all(c)]).then(function(u){const l=u[0],d=u[1],f=u[2],m=u[3],y=u[4],_=[];for(let v=0,w=l.length;v<w;v++){const T=l[v],x=d[v],b=f[v],S=m[v],L=y[v];if(T===void 0)continue;T.updateMatrix(),T.matrixAutoUpdate=!0;let C;switch(re[L.path]){case re.weights:C=Ds;break;case re.rotation:C=Wt;break;case re.position:case re.scale:default:C=Ps;break}const A=T.name?T.name:T.uuid,k=S.interpolation!==void 0?Bi[S.interpolation]:Kt,M=[];re[L.path]===re.weights?T.traverse(function(I){I.morphTargetInfluences&&M.push(I.name?I.name:I.uuid)}):M.push(A);let P=b.array;if(b.normalized){const I=mt(P.constructor),V=new Float32Array(P.length);for(let N=0,ae=P.length;N<ae;N++)V[N]=P[N]*I;P=V}for(let I=0,V=M.length;I<V;I++){const N=new C(M[I]+"."+re[L.path],x.array,P,k);S.interpolation==="CUBICSPLINE"&&(N.createInterpolant=function(K){const j=this instanceof Wt?Ii:ue;return new j(this.times,this.values,this.getValueSize()/3,K)},N.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),_.push(N)}}const g=n.name?n.name:"animation_"+e;return new Fs(g,void 0,_)})}createNodeMesh(e){const t=this.json,n=this,i=t.nodes[e];return i.mesh===void 0?null:n.getDependency("mesh",i.mesh).then(function(o){const r=n._getNodeRef(n.meshCache,i.mesh,o);return i.weights!==void 0&&r.traverse(function(a){if(!!a.isMesh)for(let c=0,u=i.weights.length;c<u;c++)a.morphTargetInfluences[c]=i.weights[c]}),r})}loadNode(e){const t=this.json,n=this.extensions,i=this,o=t.nodes[e],r=o.name?i.createUniqueName(o.name):"";return function(){const a=[],c=i._invokeOne(function(u){return u.createNodeMesh&&u.createNodeMesh(e)});return c&&a.push(c),o.camera!==void 0&&a.push(i.getDependency("camera",o.camera).then(function(u){return i._getNodeRef(i.cameraCache,o.camera,u)})),i._invokeAll(function(u){return u.createNodeAttachment&&u.createNodeAttachment(e)}).forEach(function(u){a.push(u)}),Promise.all(a)}().then(function(a){let c;if(o.isBone===!0?c=new Ns:a.length>1?c=new Je:a.length===1?c=a[0]:c=new Is,c!==a[0])for(let u=0,l=a.length;u<l;u++)c.add(a[u]);if(o.name&&(c.userData.name=o.name,c.name=r),de(c,o),o.extensions&&Oe(n,c,o),o.matrix!==void 0){const u=new $t;u.fromArray(o.matrix),c.applyMatrix4(u)}else o.translation!==void 0&&c.position.fromArray(o.translation),o.rotation!==void 0&&c.quaternion.fromArray(o.rotation),o.scale!==void 0&&c.scale.fromArray(o.scale);return i.associations.has(c)||i.associations.set(c,{}),i.associations.get(c).nodes=e,c})}loadScene(e){const t=this.json,n=this.extensions,i=this.json.scenes[e],o=this,r=new Je;i.name&&(r.name=o.createUniqueName(i.name)),de(r,i),i.extensions&&Oe(n,r,i);const a=i.nodes||[],c=[];for(let u=0,l=a.length;u<l;u++)c.push(xn(a[u],r,t,o));return Promise.all(c).then(function(){const u=l=>{const d=new Map;for(const[f,m]of o.associations)(f instanceof He||f instanceof qt)&&d.set(f,m);return l.traverse(f=>{const m=o.associations.get(f);m!=null&&d.set(f,m)}),d};return o.associations=u(r),r})}}function xn(s,e,t,n){const i=t.nodes[s];return n.getDependency("node",s).then(function(o){if(i.skin===void 0)return o;let r;return n.getDependency("skin",i.skin).then(function(a){r=a;const c=[];for(let u=0,l=r.joints.length;u<l;u++)c.push(n.getDependency("node",r.joints[u]));return Promise.all(c)}).then(function(a){return o.traverse(function(c){if(!c.isMesh)return;const u=[],l=[];for(let d=0,f=a.length;d<f;d++){const m=a[d];if(m){u.push(m);const y=new $t;r.inverseBindMatrices!==void 0&&y.fromArray(r.inverseBindMatrices.array,d*16),l.push(y)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',r.joints[d])}c.bind(new Bs(u,l),c.matrixWorld)}),o})}).then(function(o){e.add(o);const r=[];if(i.children){const a=i.children;for(let c=0,u=a.length;c<u;c++){const l=a[c];r.push(xn(l,o,t,n))}}return Promise.all(r)})}function Ki(s,e,t){const n=e.attributes,i=new q;if(n.POSITION!==void 0){const a=t.json.accessors[n.POSITION],c=a.min,u=a.max;if(c!==void 0&&u!==void 0){if(i.set(new D(c[0],c[1],c[2]),new D(u[0],u[1],u[2])),a.normalized){const l=mt(Ce[a.componentType]);i.min.multiplyScalar(l),i.max.multiplyScalar(l)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const o=e.targets;if(o!==void 0){const a=new D,c=new D;for(let u=0,l=o.length;u<l;u++){const d=o[u];if(d.POSITION!==void 0){const f=t.json.accessors[d.POSITION],m=f.min,y=f.max;if(m!==void 0&&y!==void 0){if(c.setX(Math.max(Math.abs(m[0]),Math.abs(y[0]))),c.setY(Math.max(Math.abs(m[1]),Math.abs(y[1]))),c.setZ(Math.max(Math.abs(m[2]),Math.abs(y[2]))),f.normalized){const _=mt(Ce[f.componentType]);c.multiplyScalar(_)}a.max(c)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}i.expandByVector(a)}s.boundingBox=i;const r=new Hs;i.getCenter(r.center),r.radius=i.min.distanceTo(i.max)/2,s.boundingSphere=r}function An(s,e,t){const n=e.attributes,i=[];function o(r,a){return t.getDependency("accessor",r).then(function(c){s.setAttribute(a,c)})}for(const r in n){const a=ht[r]||r.toLowerCase();a in s.attributes||i.push(o(n[r],a))}if(e.indices!==void 0&&!s.index){const r=t.getDependency("accessor",e.indices).then(function(a){s.setIndex(a)});i.push(r)}return de(s,e),Ki(s,e,t),Promise.all(i).then(function(){return e.targets!==void 0?Hi(s,e.targets,t):s})}function Sn(s,e){let t=s.getIndex();if(t===null){const r=[],a=s.getAttribute("position");if(a!==void 0){for(let c=0;c<a.count;c++)r.push(c);s.setIndex(r),t=s.getIndex()}else return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),s}const n=t.count-2,i=[];if(e===Yt)for(let r=1;r<=n;r++)i.push(t.getX(0)),i.push(t.getX(r)),i.push(t.getX(r+1));else for(let r=0;r<n;r++)r%2==0?(i.push(t.getX(r)),i.push(t.getX(r+1)),i.push(t.getX(r+2))):(i.push(t.getX(r+2)),i.push(t.getX(r+1)),i.push(t.getX(r)));i.length/3!==n&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const o=s.clone();return o.setIndex(i),o}const _t=new WeakMap;class Rn extends Gt{constructor(e){super(e);this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,n,i){const o=new Ie(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,r=>{const a={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(r,a).then(t).catch(i)},n,i)}decodeDracoFile(e,t,n,i){const o={attributeIDs:n||this.defaultAttributeIDs,attributeTypes:i||this.defaultAttributeTypes,useUniqueIDs:!!n};this.decodeGeometry(e,o).then(t)}decodeGeometry(e,t){for(const c in t.attributeTypes){const u=t.attributeTypes[c];u.BYTES_PER_ELEMENT!==void 0&&(t.attributeTypes[c]=u.name)}const n=JSON.stringify(t);if(_t.has(e)){const c=_t.get(e);if(c.key===n)return c.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let i;const o=this.workerNextTaskID++,r=e.byteLength,a=this._getWorker(o,r).then(c=>(i=c,new Promise((u,l)=>{i._callbacks[o]={resolve:u,reject:l},i.postMessage({type:"decode",id:o,taskConfig:t,buffer:e},[e])}))).then(c=>this._createGeometry(c.geometry));return a.catch(()=>!0).then(()=>{i&&o&&this._releaseTask(i,o)}),_t.set(e,{key:n,promise:a}),a}_createGeometry(e){const t=new Xt;e.index&&t.setIndex(new Ue(e.index.array,1));for(let n=0;n<e.attributes.length;n++){const i=e.attributes[n],o=i.name,r=i.array,a=i.itemSize;t.setAttribute(o,new Ue(r,a))}return t}_loadLibrary(e,t){const n=new Ie(this.manager);return n.setPath(this.decoderPath),n.setResponseType(t),n.setWithCredentials(this.withCredentials),new Promise((i,o)=>{n.load(e,i,void 0,o)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(n=>{const i=n[0];e||(this.decoderConfig.wasmBinary=n[1]);const o=Xi.toString(),r=["/* draco decoder */",i,"","/* worker */",o.substring(o.indexOf("{")+1,o.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([r]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const i=new Worker(this.workerSourceURL);i._callbacks={},i._taskCosts={},i._taskLoad=0,i.postMessage({type:"init",decoderConfig:this.decoderConfig}),i.onmessage=function(o){const r=o.data;switch(r.type){case"decode":i._callbacks[r.id].resolve(r);break;case"error":i._callbacks[r.id].reject(r);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+r.type+'"')}},this.workerPool.push(i)}else this.workerPool.sort(function(i,o){return i._taskLoad>o._taskLoad?-1:1});const n=this.workerPool[this.workerPool.length-1];return n._taskCosts[e]=t,n._taskLoad+=t,n})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}function Xi(){let s,e;onmessage=function(r){const a=r.data;switch(a.type){case"init":s=a.decoderConfig,e=new Promise(function(l){s.onModuleLoaded=function(d){l({draco:d})},DracoDecoderModule(s)});break;case"decode":const c=a.buffer,u=a.taskConfig;e.then(l=>{const d=l.draco,f=new d.Decoder,m=new d.DecoderBuffer;m.Init(new Int8Array(c),c.byteLength);try{const y=t(d,f,m,u),_=y.attributes.map(g=>g.array.buffer);y.index&&_.push(y.index.array.buffer),self.postMessage({type:"decode",id:a.id,geometry:y},_)}catch(y){console.error(y),self.postMessage({type:"error",id:a.id,error:y.message})}finally{d.destroy(m),d.destroy(f)}});break}};function t(r,a,c,u){const l=u.attributeIDs,d=u.attributeTypes;let f,m;const y=a.GetEncodedGeometryType(c);if(y===r.TRIANGULAR_MESH)f=new r.Mesh,m=a.DecodeBufferToMesh(c,f);else if(y===r.POINT_CLOUD)f=new r.PointCloud,m=a.DecodeBufferToPointCloud(c,f);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!m.ok()||f.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+m.error_msg());const _={index:null,attributes:[]};for(const g in l){const v=self[d[g]];let w,T;if(u.useUniqueIDs)T=l[g],w=a.GetAttributeByUniqueId(f,T);else{if(T=a.GetAttributeId(f,r[l[g]]),T===-1)continue;w=a.GetAttribute(f,T)}_.attributes.push(i(r,a,f,g,v,w))}return y===r.TRIANGULAR_MESH&&(_.index=n(r,a,f)),r.destroy(f),_}function n(r,a,c){const l=c.num_faces()*3,d=l*4,f=r._malloc(d);a.GetTrianglesUInt32Array(c,d,f);const m=new Uint32Array(r.HEAPF32.buffer,f,l).slice();return r._free(f),{array:m,itemSize:1}}function i(r,a,c,u,l,d){const f=d.num_components(),y=c.num_points()*f,_=y*l.BYTES_PER_ELEMENT,g=o(r,l),v=r._malloc(_);a.GetAttributeDataArrayForAllPoints(c,d,g,_,v);const w=new l(r.HEAPF32.buffer,v,y).slice();return r._free(v),{name:u,array:w,itemSize:f}}function o(r,a){switch(a){case Float32Array:return r.DT_FLOAT32;case Int8Array:return r.DT_INT8;case Int16Array:return r.DT_INT16;case Int32Array:return r.DT_INT32;case Uint8Array:return r.DT_UINT8;case Uint16Array:return r.DT_UINT16;case Uint32Array:return r.DT_UINT32}}}function Bo(s,e){const t={};for(const n of e)t[n]=s.getExtension(n);return t}function Yi(s,e,t){const n=s.createShader(e);if(s.shaderSource(n,t),s.compileShader(n),s.getShaderParameter(n,s.COMPILE_STATUS))return n;const o=t.split(`
`).map((r,a)=>`${a+1}: ${r}`).join(`
`);throw console.log(o),s.getShaderInfoLog(n)}function Wi(s,e,t,n,i){const o=s.createProgram();if(s.attachShader(o,e),s.attachShader(o,t),n&&s.transformFeedbackVaryings(o,n,i),s.linkProgram(o),s.detachShader(o,e),s.detachShader(o,t),s.getProgramParameter(o,s.LINK_STATUS))return o;throw s.getProgramInfoLog(o)}function $i(s,e){const t={},n=s.getProgramParameter(e,s.ACTIVE_UNIFORMS);for(let i=0;i<n;i++){const{name:o,type:r}=s.getActiveUniform(e,i),a=s.getUniformLocation(e,o);a&&(t[o]={type:r,location:a})}return t}function qi(s,e){const t={},n=s.getProgramParameter(e,s.ACTIVE_ATTRIBUTES);for(let i=0;i<n;i++){const{name:o}=s.getActiveAttrib(e,i);o&&(t[o]=s.getAttribLocation(e,o))}return t}function Qi(s,{color:e,depth:t}){const n=s.createFramebuffer();function i(){s.bindFramebuffer(s.FRAMEBUFFER,n)}function o(){s.bindFramebuffer(s.FRAMEBUFFER,null)}function r(){s.deleteFramebuffer(n)}function a(){i();const c=[];for(let u in e){u=Number(u),u===void 0&&console.error("invalid location");const l=e[u];s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+u,l.target,l.texture,0),c.push(s.COLOR_ATTACHMENT0+u)}s.drawBuffers(c),t&&s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,t.target,t.texture),o()}return a(),{color:e,bind:i,unbind:o,dispose:r}}let gt;function Ji(s){return{[s.FLOAT]:J(1,"f"),[s.FLOAT_VEC2]:J(2,"f"),[s.FLOAT_VEC3]:J(3,"f"),[s.FLOAT_VEC4]:J(4,"f"),[s.INT]:J(1,"i"),[s.INT_VEC2]:J(2,"i"),[s.INT_VEC3]:J(3,"i"),[s.INT_VEC4]:J(4,"i"),[s.SAMPLER_2D]:J(1,"i"),[s.SAMPLER_2D_ARRAY]:J(1,"i"),[s.FLOAT_MAT2]:bt(2,2),[s.FLOAT_MAT3]:bt(3,3),[s.FLOAT_MAT4]:bt(4,4)}}function J(s,e){return{values:`uniform${s}${e}`,array:`uniform${s}${e}v`}}function bt(s,e){return{matrix:s===e?`uniformMatrix${s}fv`:`uniformMatrix${s}x${e}fv`}}function Zi(s,e){const t=$i(s,e),n={},i=[];for(let c in t){const{type:u,location:l}=t[c],d={type:u,location:l,v0:0,v1:0,v2:0,v3:0};n[c]=d}const o=new Set;function r(c,u,l,d,f){const m=n[c];if(!m){o.has(c)||o.add(c);return}m.v0=u,m.v1=l,m.v2=d,m.v3=f,i.push(m)}gt=gt||Ji(s);function a(){for(;i.length>0;){const{type:c,location:u,v0:l,v1:d,v2:f,v3:m}=i.pop(),y=gt[c];if(l&&l.length)if(y.matrix){const _=l,g=d||!1;s[y.matrix](u,g,_)}else s[y.array](u,l);else s[y.values](u,l,d,f,m)}}return{setUniform:r,upload:a}}function eo(s){let e="";for(const t in s){const n=s[t];n&&(e+=`#define ${t} ${n}
`)}return e}function Ln(s){let e={};for(let t=0;t<s.length;t++)e[s[t]]=t;return e}function to(s){let e="";const t=Ln(s);for(let n in t)e+=`layout(location = ${t[n]}) out vec4 out_${n};
`;return e}function no(s,e){let t="";for(let n of s)typeof n=="function"?t+=n(e):t+=n;return t}function Mn(s,e,t,n){let i=`#version 300 es
precision mediump float;
precision mediump int;
precision lowp isampler2D;
`;return n&&(i+=eo(n)),e===s.FRAGMENT_SHADER&&t.outputs&&(i+=to(t.outputs)),t.includes&&(i+=no(t.includes,n)),typeof t.source=="function"?i+=t.source(n):i+=t.source,Yi(s,e,i)}function so(s,{defines:e,vertex:t}){return Mn(s,s.VERTEX_SHADER,t,e)}function io(s,{defines:e,fragment:t}){return Mn(s,s.FRAGMENT_SHADER,t,e)}function oo(s,e){const t=Zi(s,e),n={};let i=1;function o(l,d){if(!!d)if(n[l])n[l].tex=d;else{const f=i++;t.setUniform(l,f),n[l]={unit:f,tex:d}}}function r(){for(let l in n){const{tex:d,unit:f}=n[l];s.activeTexture(s.TEXTURE0+f),s.bindTexture(d.target,d.texture)}}function a(l,d,f,m){const{tex:y,unit:_}=n[l];s.activeTexture(s.TEXTURE0+_),s.bindTexture(y.target,y.texture)}function c(l=!0){s.useProgram(e),t.upload(),l&&r()}function u(){for(const l in n){const{tex:d}=n[l];s.deleteTexture(d.texture)}s.deleteProgram(e)}return{attribLocs:qi(s,e),bindTextures:r,updateTexture:a,program:e,setTexture:o,setUniform:t.setUniform,textures:n,useProgram:c,dispose:u}}function ro(s,e){const{fragment:t,vertex:n}=e,i=n instanceof WebGLShader?n:so(s,e),o=t instanceof WebGLShader?t:io(s,e),r=Wi(s,i,o);return Bt(It({},oo(s,r)),{outputLocs:t.outputs?Ln(t.outputs):{}})}function ao(s,e,t){return Math.min(Math.max(s,e),t)}function Uo(s){for(let e=s.length-1;e>0;e--){const t=Math.floor(Math.random()*(e+1)),n=s[e];s[e]=s[t],s[t]=n}return s}function Ho(s,e,t=1e-4){for(let n=0;n<s.length;n++)if(Math.abs(s[n]-e[n])>t)return!1;return!0}function co(s){const e=Math.round(Math.log2(Math.sqrt(s))),t=2**e,n=Math.ceil(s/t);return{columnsLog:e,columns:t,rows:n,size:n*t}}function lo(s,e){const t=new s.constructor(e);return t.set(s),t}function Go(s,e,t){const n=co(e.length/t);return Cn(s,{data:lo(e,t*n.size),width:n.columns,height:n.rows})}function Cn(s,e){let{width:t=null,height:n=null,data:i=null,length:o=1,channels:r=null,storage:a=null,flipY:c=!1,gammaCorrection:u=!1,wrapS:l=s.CLAMP_TO_EDGE,wrapT:d=s.CLAMP_TO_EDGE,minFilter:f=s.NEAREST,magFilter:m=s.NEAREST}=e;t=t||i.width||0,n=n||i.height||0;const y=s.createTexture();let _,g;Array.isArray(i)&&(g=i,i=g[0]),_=g||o>1?s.TEXTURE_2D_ARRAY:s.TEXTURE_2D,s.activeTexture(s.TEXTURE0),s.bindTexture(_,y),!Array.isArray(l)&&s.texParameteri(_,s.TEXTURE_WRAP_S,l),!Array.isArray(d)&&s.texParameteri(_,s.TEXTURE_WRAP_T,d),s.texParameteri(_,s.TEXTURE_MIN_FILTER,f),s.texParameteri(_,s.TEXTURE_MAG_FILTER,m),r||(i&&i.length?r=i.length/(t*n):r=4),r=ao(r,1,4);const{type:v,format:w,internalFormat:T}=fo(s,r,a,i,u);if(g){s.texStorage3D(_,1,T,t,n,g.length);for(let b=0;b<g.length;b++){const S=g[b].width||t,L=g[b].height||n;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,Array.isArray(c)?c[b]:c),s.texParameteri(_,s.TEXTURE_WRAP_S,Array.isArray(l)?l[b]:l),s.texParameteri(_,s.TEXTURE_WRAP_T,Array.isArray(d)?d[b]:d),s.texSubImage3D(_,0,0,0,b,S,L,1,w,v,g[b])}}else o>1?s.texStorage3D(_,1,T,t,n,o):(s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,c),s.texStorage2D(_,1,T,t,n),i&&s.texSubImage2D(_,0,0,0,t,n,w,v,i));s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,!1);function x(){s.deleteTexture(y)}return{target:_,texture:y,dispose:x}}function Vo(s,e,t){const n=s.createRenderbuffer(),i=s.RENDERBUFFER;s.bindRenderbuffer(i,n),s.renderbufferStorage(s.RENDERBUFFER,s.DEPTH_COMPONENT24,e,t),s.bindRenderbuffer(i,null);function o(){s.deleteRenderbuffer(n)}return{target:i,texture:n,dispose:o}}function uo(s,e){return{1:s.RED,2:s.RG,3:s.RGB,4:s.RGBA}[e]}function fo(s,e,t,n,i){let o,r;const a=n instanceof Uint8Array||n instanceof HTMLImageElement||n instanceof HTMLCanvasElement||n instanceof ImageData||n instanceof ImageBitmap,c=n instanceof Float32Array;return t==="byte"||!t&&a?(r={1:s.R8,2:s.RG8,3:i?s.SRGB8:s.RGB8,4:i?s.SRGB8_ALPHA8:s.RGBA8}[e],o=s.UNSIGNED_BYTE):t==="float"||!t&&c?(r={1:s.R32F,2:s.RG32F,3:s.RGB32F,4:s.RGBA32F}[e],o=s.FLOAT):t==="halfFloat"?(r={1:s.R16F,2:s.RG16F,3:s.RGB16F,4:s.RGBA16F}[e],o=s.HALF_FLOAT):t==="snorm"&&(r={1:s.R8_SNORM,2:s.RG8_SNORM,3:s.RGB8_SNORM,4:s.RGBA8_SNORM}[e],o=s.UNSIGNED_BYTE),{format:uo(s,e),internalFormat:r,type:o}}const jo=0,ho=["map","normalMap","roughnessMap","metalnessMap","specularMap","glossinessMap","emissiveMap"],yt=new Map;yt.set(jt,0);yt.set(Be,1);yt.set(zt,2);const zo=s=>{const e=ho.length,t=9,n=s.size*e*t,i=3,o=s.size*e*i;return{mapNum:e,perMatrixLength:t,perWrappingDataLength:i,uvTransDataLength:n,textureWrappingDataLength:o,bufferSize:n+o}};class Ko extends He{constructor(){super();this.materialType=null,this.isRayTracingMaterial=!0}copy(e){super.copy(e),this.materialType=e.materialType,this.isRayTracingMaterial=e.isRayTracingMaterial}}function po(s,e,t=0,n=s.length){for(;t!==n;){for(;e(s[t]);)if(t++,t===n)return t;do if(n--,t===n)return t;while(!e(s[n]));On(s,t,n),t++}return t}function mo(s,e,t=0,n=s.length,i=Math.floor((t+n)/2)){for(let o=t;o<=i;o++){let r=o,a=s[o];for(let c=o+1;c<n;c++)e(a,s[c])||(r=c,a=s[c],On(s,o,r))}}function On(s,e,t){const n=s[t];s[t]=s[e],s[e]=n}const z=new D;function kn(s,e){return{primitives:s,bounds:e}}function _o(s,e,t){return{child0:e,child1:t,bounds:new q().union(e.bounds).union(t.bounds),splitAxis:s}}function go(s){return s.getSize(z),z.x>z.z?z.x>z.y?"x":"y":z.z>z.y?"z":"y"}function Pn(s,e,t){let n=t[e]-s.min[e];return s.max[e]>s.min[e]&&(n/=s.max[e]-s.min[e]),n}function Et(s){return s.getSize(z),2*(z.x*z.z+z.x*z.y+z.z*z.y)}function Xe(s,e,t){const n=new q;for(let o=e;o<t;o++)n.union(s[o].bounds);const i=t-e;if(i===1)return kn(s.slice(e,t),n);{const o=new q;for(let c=e;c<t;c++)o.expandByPoint(s[c].center);const r=go(o);let a=Math.floor((e+t)/2);if(i<=4)mo(s,(c,u)=>c.center[r]<u.center[r],e,t,a);else{if(o.max[r]===o.min[r])return kn(s.slice(e,t),n);{const c=12,u=[];for(let m=0;m<c;m++)u.push({bounds:new q,count:0});for(let m=e;m<t;m++){let y=Math.floor(c*Pn(o,r,s[m].center));y===u.length&&(y=u.length-1),u[y].count++,u[y].bounds.union(s[m].bounds)}const l=[];for(let m=0;m<u.length-1;m++){const y=new q,_=new q;let g=0,v=0;for(let w=0;w<=m;w++)y.union(u[w].bounds),g+=u[w].count;for(let w=m+1;w<u.length;w++)_.union(u[w].bounds),v+=u[w].count;l.push(.1+(g*Et(y)+v*Et(_))/Et(n))}let d=l[0],f=0;for(let m=1;m<l.length;m++)l[m]<d&&(d=l[m],f=m);a=po(s,m=>{let y=Math.floor(u.length*Pn(o,r,m.center));return y===u.length&&(y=u.length-1),y<=f},e,t)}}return _o(r,Xe(s,e,a),Xe(s,a,t))}}function bo(s){const e=[];for(let t=0;t<s.length;t++){const n=[],o=s[t].geometry,r=o.getIndex?o.getIndex().array:o.index.array,a=o.getAttribute?o.getAttribute("position"):o.attributes.position,c=new D,u=new D,l=new D,d=new D,f=new D;for(let m=0;m<r.length;m+=3){const y=r[m],_=r[m+1],g=r[m+2],v=new q;a.getX?(c.fromBufferAttribute(a,y),u.fromBufferAttribute(a,_),l.fromBufferAttribute(a,g)):(c.x=a.array[y*a.itemSize],c.y=a.array[y*a.itemSize+1],c.z=a.array[y*a.itemSize+2],u.x=a.array[_*a.itemSize],u.y=a.array[_*a.itemSize+1],u.z=a.array[_*a.itemSize+2],l.x=a.array[g*a.itemSize],l.y=a.array[g*a.itemSize+1],l.z=a.array[g*a.itemSize+2]),v.expandByPoint(c),v.expandByPoint(u),v.expandByPoint(l),d.subVectors(l,c),f.subVectors(u,c);const w=new D().crossVectors(f,d).normalize(),T={bounds:v,center:v.getCenter(new D),indices:[y,_,g],faceNormal:w,meshID:t};n.push(T)}e.push(n)}return e}function yo(s,e){const t=[];for(let n=0;n<s.length;n++){const i=s[n],{material:o,geometry:r}=i,a=new q;r.computeBoundingBox(),a.copy(r.boundingBox).applyMatrix4(i.matrixWorld);const c={bounds:a,center:a.getCenter(new D),meshID:n,materialID:e.get(o),visible:Number(i.visible)};t.push(c)}return t}function Xo(s,e){const t=yo(s,e);return Xe(t,0,t.length)}function Yo(s){const e=bo(s),t=[];for(let n=0;n<e.length;n++){const i=e[n],o=Xe(i,0,i.length);t.push(o)}return t}var Eo={source:`vec4 LGL_Ay(sampler2D map,vec2 uv){
#ifdef OES_texture_float_linear
return texture(map,uv);
#else
vec2 size=vec2(textureSize(map,0));vec2 texelSize=1.0/size;uv=uv*size-0.5;vec2 f=fract(uv);uv=floor(uv)+0.5;vec4 s1=texture(map,(uv+vec2(0,0))*texelSize);vec4 s2=texture(map,(uv+vec2(1,0))*texelSize);vec4 s3=texture(map,(uv+vec2(0,1))*texelSize);vec4 s4=texture(map,(uv+vec2(1,1))*texelSize);return mix(mix(s1,s2,f.x),mix(s3,s4,f.x),f.y);
#endif
}layout(location=0)out vec4 out_color;in vec2 vCoord;uniform sampler2D lightTex;uniform vec2 lightScale;uniform int toneMappingFun;vec3 linear(vec3 color){return color;}vec3 LGL_BG(vec3 color){return clamp(color/(vec3(1.0)+color),vec3(0.0),vec3(1.0));}vec3 LGL_BH(vec3 color){color=max(vec3(0.0),color-0.004);return pow((color*(6.2*color+0.5))/(color*(6.2*color+1.7)+0.06),vec3(2.2));}vec3 LGL_BI(vec3 color){return clamp((color*(2.51*color+0.03))/(color*(2.43*color+0.59)+0.14),vec3(0.0),vec3(1.0));}void main(){vec4 upscaledLight=texture(lightTex,lightScale*vCoord);vec3 light=upscaledLight.rgb/upscaledLight.a;if(toneMappingFun==0){light=linear(light);}if(toneMappingFun==1){light=LGL_BI(light);}if(toneMappingFun==2){light=LGL_BG(light);}if(toneMappingFun==3){light=LGL_BH(light);}light=pow(light,vec3(1.0/2.2));if(upscaledLight.a==0.){out_color=vec4(light,0.0);}else{out_color=vec4(light,1.0);}}`};const Dn={[Gs]:0,[Vs]:1,[js]:2,[zs]:3};function Wo(s,e){const{fullscreenQuad:t,toneMapping:n}=e;let i;function o(m,y){i=(()=>Qi(s,{color:{0:Cn(s,{width:m,height:y,storage:"byte",magFilter:s.LINEAR,minFilter:s.LINEAR})}}))()}const r={gl:s,vertex:t.vertexShader,fragment:Eo},a=ro(s,r);a.setUniform("toneMappingFun",Dn[n]);const c=new X(1,1);function u(m,y){let{light:_,lightScale:g}=m;if(g=g||c,a.setTexture("lightTex",_),a.setUniform("lightScale",g.x,g.y),y)return i.bind(),s.clear(s.COLOR_BUFFER_BIT),s.viewport(0,0,s.drawingBufferWidth,s.drawingBufferHeight),a.useProgram(),t.draw(),i.unbind(),i;a.useProgram(),t.draw()}function l(m,y){o(m,y)}function d(m){a.setUniform("toneMappingFun",Dn[m])}function f(){a.dispose()}return{draw:u,setToneMapping:d,setSize:l,dispose:f}}class vo extends ve{constructor(e,t,n=10,i=10){super(e,t);this.type="RectAreaLight",this.width=n,this.height=i,this.target=new D}copy(e){super.copy(e),this.width=e.width,this.height=e.height}}class To extends ve{constructor(e,t,n,i){super(e,t);this.type="QuadLight",this.v1=n,this.v2=i}}class wo extends ve{constructor(e,t,n=1){super(e,t);this.type="SphereAreaLight",this.radius=n}}class xo extends ve{constructor(e,t){super(e,t);this.type="PointLight"}}class Ao extends ve{constructor(e,t){super(e,t);this.type="DirectionalLight",this.target=new D}}function So(s){const e=new q;return e.setFromObject(s),e}function $o(s,e,t){const n=So(t),i=new D;n.getCenter(i);const o=n.min.distanceTo(n.max);s.position.set(0,(n.max.y-n.min.y)*.5,o*1),s.aperture=.01*o,e.target.copy(i),e.update()}function Fn(s,e,t){const n=new Ks;return n.setURLModifier((i,o)=>{const r=e+i.replace(s,"").replace(/^(\.?\/)/,"");if(t&&t.has(r)){const a=t.get(r);return URL.createObjectURL(a)}return(o||"")+i}),n}function qo(s){return new Promise((e,t)=>{new dt().load(s,i=>{e(i)},void 0,t)})}function Qo(s){return new Promise((e,t)=>{const n=new dt;n.setDRACOLoader(new Rn().setDecoderPath("/draco/gltf/")),n.setCrossOrigin("anonymous"),n.load(s,i=>{e(i)},void 0,t)})}function Ro(s,e,t){const n=te.extractUrlBase(s);return new Promise((i,o)=>{const r=Fn(n,e,t),a=new dt(r);a.setDRACOLoader(new Rn().setDecoderPath("/draco/gltf/")),a.setCrossOrigin("anonymous"),a.load(s,c=>{i(c)},void 0,o)})}function Jo(s){let e,t;Array.from(s).forEach(([i,o])=>{o.name.match(/\.(gltf|glb)$/)&&(e=o,t=i.replace(o.name,""))}),e||console.error("No .gltf or .glb asset found.");const n=typeof e=="string"?e:URL.createObjectURL(e);return Ro(n,t,s)}function Lo(s,e){const t=te.extractUrlBase(s);return new Promise((n,i)=>{const o=Fn(t,e);new Ys(o).setDataType(Fe).load(s,a=>{n(a)},void 0,i)})}function Zo(s){let e,t;Array.from(s).forEach(([i,o])=>{o.name.match(/\.(hdr)$/)&&(e=o,t=i.replace(o.name,""))}),e||console.error("No .hdr asset found.");const n=typeof e=="string"?e:URL.createObjectURL(e);return Lo(n,t)}function er(s,e){!s||s.length==0||s.forEach(t=>{switch(t.type){case"PointLight":const n=new xo(new G().fromArray(t.emission),1);n.position.fromArray(t.position),e.add(n);break;case"QuadLight":const i=new To(new G().fromArray(t.emission),1,new D().fromArray(t.v1),new D().fromArray(t.v2));i.position.fromArray(t.position),t.visible!=null&&(i.visible=t.visible),e.add(i);break;case"RectAreaLight":const o=new vo(new G().fromArray(t.emission),1,t.width,t.height);o.position.fromArray(t.position),t.target&&o.target.fromArray(t.target),t.visible!=null&&(o.visible=t.visible),e.add(o);break;case"SphereAreaLight":const r=new wo(new G().fromArray(t.emission),1,t.radius);r.position.fromArray(t.position),t.visible!=null&&(r.visible=t.visible),e.add(r);break;case"DirectionalLight":const a=new Ao(new G().fromArray(t.emission),1);a.position.fromArray(t.position),t.target&&a.target.fromArray(t.target),e.add(a);break;default:console.warn(`No support light type: ${t.type}`);break}})}function tr(s){return window.localStorage[s]=="undefined"?null:JSON.parse(localStorage.getItem(s))}function nr(s,e){return localStorage.setItem(s,JSON.stringify(e))}export{Vo as A,Bo as B,No as C,jo as D,zo as G,Oo as O,Ys as R,ho as S,yt as T,qo as a,Qo as b,Do as c,Fo as d,ko as e,Ko as f,Po as g,tr as h,Jo as i,Zo as j,so as k,er as l,Io as m,Go as n,ro as o,Cn as p,Uo as q,Yo as r,nr as s,co as t,$o as u,Xo as v,ao as w,Qi as x,Wo as y,Ho as z};
